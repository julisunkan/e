<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/examples/xlookup.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:38:13 GMT -->
<head>

<title>How to use XLOOKUP in Excel (In Easy Steps)</title>
<meta name="keywords" content="xlookup function, excel, exact match, not found, approximate match, left lookup, horizontal lookup, multiple values, excel 365, xlookup, #n/a error, next smaller value, index, match, spilling, last match">
<meta name="description" content="If you have Excel 365 or Excel 2021, use XLOOKUP instead of VLOOKUP. The XLOOKUP function is easier to use and has some additional advantages.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="XLOOKUP function in Excel">
<meta property="og:url" content="xlookup.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="If you have Excel 365 or Excel 2021, use XLOOKUP instead of VLOOKUP. The XLOOKUP function is easier to use and has some additional advantages.">
<meta property="og:image" content="../smi/examples/xlookup.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../smi/examples/xlookup.png">

<link rel="preload" href="../css/style.css" as="style">
<link rel="preload" href="images/xlookup/xlookup-arguments.png" as="image">
<link rel="preload" href="../js/default.js" as="script">
<link rel="preload" href="../js/init.js" as="script">
<script async src="../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../css/style.css"/>
<script src="../js/default.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../css/skel.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/adslot.css" />
</noscript>
<link rel="icon" href="../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../index.html"><img src="../layout/excel-guides.svg" onerror="this.src='../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../index.html">Excel</a></li>
                  <li><a href="../introduction.html">Introduction</a></li>
				  <li><a href="../basics.html">Basics</a></li>
				  <li><a href="../functions.html">Functions</a></li>
				  <li><a href="../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../examples.html">300 Examples</a></li>
                  <li><a href="../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">XLOOKUP</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
<p class="spacing"><a href="#exact-match">Exact Match</a> | <a href="#not-found">Not Found</a> | <a href="#approximate-match">Approximate Match</a> | <a href="#left-lookup">Left Lookup</a> | <a href="#multiple-values">Multiple Values</a> | <a href="#horizontal-lookup">Horizontal Lookup</a> | <a href="#last-match">Last Match</a></p>
<p>If you have Excel 365 or Excel 2021, use XLOOKUP instead of <a href="vlookup.html">VLOOKUP</a>. The <strong>XLOOKUP function</strong> is easier to use and has some additional advantages.</p>
<h3><a name="exact-match" id="exact-match"></a>Exact Match</h3>
<p>By default, the XLOOKUP function in <strong>Excel 365/2021</strong> performs an exact match.</p>
<p>1. The XLOOKUP function below looks up the value 53 (first argument) in the range B3:B9 (second argument).</p>
              <p><img src="images/xlookup/xlookup-arguments.png" alt="XLOOKUP arguments" width="604" height="267" title="XLOOKUP arguments" /></p>
              

     
     
     
              <p>2. Next, it simply returns the value in the same row from the range E3:E9 (third argument).</p>
              <p><img src="images/xlookup/xlookup-function.png" alt="XLOOKUP function in Excel" width="604" height="267" title="XLOOKUP function in Excel" /></p>
              <p>3. Here's another example. Instead of returning the salary, the XLOOKUP function below returns the last name (replace E3:E9 with D3:D9) of ID 79.</p>
              <p><img src="images/xlookup/exact-match.png" loading="lazy" alt="Exact Match" width="604" height="267" title="Exact Match" /></p>
              <h3><a name="not-found" id="not-found"></a>Not Found</h3>
              <p>If the XLOOKUP function cannot find a match, it returns a #N/A error.</p>
              <p>1. For example, the XLOOKUP function below cannot find the value 28 in the range B3:B9.</p>
              <p><img src="images/xlookup/na-error.png" loading="lazy" alt="#N/A Error" width="604" height="267" title="#N/A Error" /></p>
              <p>2. Use the fourth argument of the XLOOKUP function to replace the #N/A error with a friendly message.</p>
              <p><img src="images/xlookup/not-found.png" loading="lazy" alt="Not Found" width="604" height="267" title="Not Found" /></p>
			  <div class="ad"><!-- Advanced Excel Pages Middle -->

     
     
     
</div>
              <h3><a name="approximate-match" id="approximate-match"></a>Approximate Match</h3>
              <p>Let's take a look at an example of the XLOOKUP function in approximate match mode.</p>
              <p>1. The XLOOKUP function below looks up the value 85 (first argument) in the range B3:B7 (second argument). There's just one problem. There's no value 85 in this range.</p>
              <p><img src="images/xlookup/xlookup-function-approximate-match-mode.png" loading="lazy" alt="XLOOKUP function in Approximate Match Mode" width="604" height="227" title="XLOOKUP function in Approximate Match Mode" /></p> 
              <p>2. Fortunately, the value -1 (fifth argument) tells the XLOOKUP function to find the next smaller value. In this example, the value 80.</p>
              <p><img src="images/xlookup/next-smaller-value.png" loading="lazy" alt="Next Smaller Value" width="604" height="227" title="Next Smaller Value" /></p>
              <p>3. Next, it simply returns the value in the same row from the range C3:C7 (third argument).</p>
              <p><img src="images/xlookup/approximate-match.png" loading="lazy" alt="Approximate Match in Excel" width="604" height="227" title="Approximate Match in Excel" /></p>
              <p>Note: use 1 instead of -1 for the fifth argument to find the next larger value. In this example, the value 90. The XLOOKUP function also works with unsorted data. In this example, there's no need to sort the scores in ascending order.</p>
			  <h3><a name="left-lookup" id="left-lookup"></a>Left Lookup</h3>
              <p>Instead of using INDEX and MATCH in Excel to perform a <a href="left-lookup.html">left lookup</a>, simply use the XLOOKUP function. For example, take a look at the XLOOKUP function below.</p>
              <p><img src="images/xlookup/left-lookup.png" loading="lazy" alt="Left Lookup" width="604" height="267" title="Left Lookup" /></p>
              <p>Explanation: the XLOOKUP function looks up the last name and returns the ID.</p>
			  <!--<div class="ad">Excel Pages Middle

     
     
     
</div>-->
			  <h3><a name="multiple-values" id="multiple-values"></a>Multiple Values</h3>
              <p>The XLOOKUP function in Excel 365/2021 can return multiple values.</p>
              <p>1. First, the XLOOKUP function below looks up the ID and returns the first name (nothing new).</p>
              <p><img src="images/xlookup/basic-xlookup-function.png" loading="lazy" alt="Basic XLOOKUP function" width="604" height="327" title="Basic XLOOKUP function" /></p>
              <p>2. Replace C6:C12 with C6:E12 to return the first name, last name and salary.</p>
              <p><img src="images/xlookup/xlookup-can-return-multiple-values.png" loading="lazy" alt="XLOOKUP Can Return Multiple Values" width="604" height="327" title="XLOOKUP Can Return Multiple Values" /></p>
              <p>Note: the <strong>XLOOKUP</strong> function, entered into cell C3, fills multiple cells. Wow! This behavior in Excel 365/2021 is called <a href="dynamic-arrays.html">spilling</a>.</p>
			  <h3><a name="horizontal-lookup" id="horizontal-lookup"></a>Horizontal Lookup</h3>
			  <p>Instead of using the <a href="../functions/lookup-reference-functions.html#hlookup">HLOOKUP function</a> in Excel to perform a horizontal lookup, simply use the XLOOKUP function.</p>
			  <p><img src="images/xlookup/horizontal-lookup.png" loading="lazy" alt="Horizontal Lookup" width="604" height="307" title="Horizontal Lookup" /></p>
			  <p>Note: the <strong>XLOOKUP</strong> function, entered into cell B2, fills multiple cells. Wow! This behavior in Excel 365/2021 is called <a href="dynamic-arrays.html">spilling</a>.</p>
			  <h3><a name="last-match" id="last-match"></a>Last Match</h3>
			  <p>By default, the XLOOKUP function performs a first to last search (nothing new). To perform a last to first search, set the sixth argument to -1 (see example below).</p>
			  <p><img src="images/xlookup/last-match.png" loading="lazy" alt="Last Match" width="604" height="267" title="Last Match" /></p>
			  <p>Explanation: this XLOOKUP function returns the salary of Mia Reed, not Mia Clark.</p>
			  <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  <p align="left"><span class="buttonp"> <a href="xmatch.html">14/15 Completed! Learn more about lookup & reference &gt;<br />
                  </a></span>Go to Next Guide: <a href="../functions/financial-functions.html">Financial Functions</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../functions/lookup-reference-functions.html">Lookup & Reference Functions</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="vlookup.html">Vlookup</a></li>
                        <li><a href="tax-rates.html">Tax Rates</a></li>
                        <li><a href="index-match.html">Index and Match</a></li>
                        <li><a href="two-way-lookup.html">Two-way Lookup</a></li>
                        <li><a href="offset.html">Offset</a></li>
                        <li><a href="case-sensitive-lookup.html">Case-sensitive Lookup</a></li>
                        <li><a href="left-lookup.html">Left Lookup</a></li>
                        <li><a href="locate-maximum-value.html">Locate Maximum Value</a></li>
                        <li><a href="indirect.html">Indirect</a></li>
                        <li><a href="two-column-lookup.html">Two-column Lookup</a></li>
                        <li><a href="closest-match.html">Closest Match</a></li>
                        <li><a href="compare-two-columns.html">Compare Two Columns</a></li>
                        <li class="current_page_item"><a href="xlookup.html">Xlookup</a></li>
						<li><a href="xmatch.html">Xmatch</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/xlookup.xlsx">xlookup.xlsx</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../functions/financial-functions.html">Financial Functions</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../layout/facebook-logo.png" onmouseover="this.src='../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../layout/x-logo.png" onmouseover="this.src='../layout/x-logo-onmouseover.png'" onmouseout="this.src='../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../layout/pinterest-logo.png" onmouseover="this.src='../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../layout/linkedin-logo.png" onmouseover="this.src='../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="xlookup.html">Xlookup</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../introduction.html">Introduction</a> &bull; <a href="../basics.html">Basics</a> &bull; <a href="../functions.html">Functions</a> &bull; <a href="../data-analysis.html">Data Analysis</a> &bull; <a href="../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  //$(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d2a7aae99fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/examples/xlookup.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:38:18 GMT -->
</html>
