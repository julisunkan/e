<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/function-sub.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:47:43 GMT -->
<head>

<title>Function and Sub in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="function, sub, excel vba, difference, visual basic editor, module, functions, subs, program size, call, return value, catch, argument">
<meta name="description" content="The difference between a function and a sub in Excel VBA is that a function can return a value while a sub cannot. Functions and subs become very useful as program size increases.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Function and Sub in Excel VBA">
<meta property="og:url" content="function-sub.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="The difference between a function and a sub in Excel VBA is that a function can return a value while a sub cannot. Functions and subs become very useful as program size increases.">
<meta property="og:image" content="../smi/vba/function-sub-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../smi/vba/function-sub-2.png">

<link rel="preload" href="../css/style.css" as="style">
<link rel="preload" href="images/function-sub/function-result.png" as="image">
<link rel="preload" href="../js/default.js" as="script">
<link rel="preload" href="../js/init.js" as="script">
<script async src="../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../css/style.css"/>
<script src="../js/default.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../css/skel.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/adslot.css" />
</noscript>
<link rel="icon" href="../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../index.html"><img src="../layout/excel-guides.svg" onerror="this.src='../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../index.html">Excel</a></li>
                  <li><a href="../introduction.html">Introduction</a></li>
				  <li><a href="../basics.html">Basics</a></li>
				  <li><a href="../functions.html">Functions</a></li>
				  <li><a href="../data-analysis.html">Data Analysis</a></li>
                  <li class="current_page_item"><a href="../vba.html">VBA</a></li>
                  <li class="pro"><a href="../examples.html">300 Examples</a></li>
                  <li><a href="../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Function and Sub</h1>
                        <div style="clear: both;">&nbsp;</div>
<div class="entry">   
<p class="spacing"><a href="#function">Function</a> | <a href="#sub">Sub</a></p>
  <p>The difference between a <strong>function</strong> and a <strong>sub</strong> in <strong>Excel VBA</strong> is that a function can return a value while a sub cannot. Functions and subs become very useful as program size increases.</p>
  <h3><a name="function" id="function"></a>Function</h3>
  <p>If you want Excel VBA to perform a task that returns a result, you can use a function. Place a function into a module (In the Visual Basic Editor, click Insert, Module). For example, the function with name Area.</p>
  <div class="code"><span class="predefined">Function</span> Area(x <span class="predefined">As</span> <span class="predefined">Double</span>, y <span class="predefined">As</span> <span class="predefined">Double</span>) <span class="predefined">As</span> <span class="predefined">Double</span><br /><br />
  Area = x * y<br /><br />
  <span class="predefined">End</span> <span class="predefined">Function</span></div>
  

     
     
     
  <p>Explanation: This function has two arguments (of type Double) and a return type (the part after As also of type Double). You can use the name of the function (Area) in your code to indicate which result you want to return (here x * y).</p>
  <p>You can now refer to this function (in other words call the function) from somewhere else in your code by simply using the name of the function and giving a value for each argument.</p>
  <p>Place a <a href="create-a-macro.html#command-button">command button</a> on your worksheet and add the following code lines:</p>
  <div class="code"><span class="predefined">Dim</span> z <span class="predefined">As</span> <span class="predefined">Double</span><br /><br />
  z = Area(3, 5) + 2<br /><br />
  MsgBox z</div>
  <p>Explanation: The function returns a value so you have to 'catch' this value in your code. You can use another variable (z) for this. Next, you can add another value to this variable (if you want). Finally, display the value using a MsgBox.</p>
  <p>Result when you click the command button on the sheet:</p>
  <p><img src="images/function-sub/function-result.png" alt="Excel VBA Function Result" width="140" height="148" title="Excel VBA Function Result" /></p>
  <h3><a name="sub" id="sub"></a>Sub</h3>
  <p>If you want Excel VBA to perform some actions, you can use a sub. Place a sub into a module (In the Visual Basic Editor, click Insert, Module). For example, the sub with name Area.</p>
  <div class="code"><span class="predefined">Sub</span> Area(x <span class="predefined">As</span> <span class="predefined">Double</span>, y <span class="predefined">As</span> <span class="predefined">Double</span>)<br /><br />
  MsgBox x * y<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>Explanation: This sub has two arguments (of type Double). It does not have a return type! You can refer to this sub (call the sub) from somewhere else in your code by simply using the name of the sub and giving a value for each argument.</p>
  <p>Place a <a href="create-a-macro.html#command-button">command button</a> on your worksheet and add the following code line:</p>
  <div class="code">Area 3, 5</div>
  <p>Result when you click the command button on the sheet:</p>
  <p><img src="images/function-sub/sub-result.png" alt="Excel VBA Sub Result" width="140" height="148" title="Excel VBA Sub Result" /></p>
  <p>Can you see the difference between the function and the sub? The function returned the value 15. We added the value 2 to this result and displayed the final result. When we called the sub we had no more control over the result (15) because a sub cannot return a value!</p>
  <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     data-ad-slot="4005850092"></ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                      <p align="left"><span class="buttonp"> <a href="examples/user-defined-function.html">1/5 Completed! Learn more about functions and subs &gt;<br />
                    </a></span>Go to Next Guide: <a href="application-object.html">Application Object</a></div>
                  </div></span>
                  
			</div>
            <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li class="current_page_item"><a href="function-sub.html">Function and Sub</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
                    <li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                                             
                      	<li><a href="examples/user-defined-function.html">User Defined Function</a></li>
                        <li><a href="examples/custom-average-function.html">Custom Average Function</a></li>
                        <li><a href="examples/volatile-functions.html">Volatile Functions</a></li>
                        <li><a href="examples/byref-byval.html">ByRef and ByVal</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/function-sub.xlsm">function-sub.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="application-object.html">Application Object</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../layout/facebook-logo.png" onmouseover="this.src='../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../layout/x-logo.png" onmouseover="this.src='../layout/x-logo-onmouseover.png'" onmouseout="this.src='../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../layout/pinterest-logo.png" onmouseover="this.src='../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../layout/linkedin-logo.png" onmouseover="this.src='../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
			  <div id="sidebar">
              <ul><li></li>
		        <li>
		          <h3><span class="notranslate">Most Popular</span></h3>
	            </li>
		        <li><ul>
                        <li><a href="range-object.html">Range Object</a></li>
                        <li><a href="loop.html">Loop</a></li>
                        <li><a href="if-then-statement.html">If Then Statement</a></li>
                        <li><a href="msgbox.html">MsgBox</a></li>
                        <li><a href="array.html">Array</a></li>
                        <li><a href="function-sub.html">Function and Sub</a></li>
                        <li><a href="userform.html">Userform</a></li>
                        </ul>
			    </li>
              </ul>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="function-sub.html">Function and Sub</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../introduction.html">Introduction</a> &bull; <a href="../basics.html">Basics</a> &bull; <a href="../functions.html">Functions</a> &bull; <a href="../data-analysis.html">Data Analysis</a> &bull; <a href="../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d45609acb8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/function-sub.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:47:44 GMT -->
</html>
