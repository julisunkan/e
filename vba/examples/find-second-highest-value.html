<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/find-second-highest-value.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:14 GMT -->
<head>

<title>Find Second Highest Value in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="find, second, highest, value, excel vba, macro, program">
<meta name="description" content="Below we will look at a program in Excel VBA that finds the second highest value.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Find Second Highest Value in Excel VBA">
<meta property="og:url" content="find-second-highest-value.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to create a program in Excel VBA that finds the second highest value.">
<meta property="og:image" content="../../smi/vba/examples/find-second-highest-value-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/find-second-highest-value-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/find-second-highest-value/find-second-highest-value-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Find Second Highest Value</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
			  <p>Below we will look at a program in <strong>Excel VBA</strong> that <strong>finds the second highest value</strong>.</p>
              <p>Situation:</p>
			  <p><img src="images/find-second-highest-value/find-second-highest-value-example.png" alt="Find Second Highest Value in Excel VBA" width="604" height="281" title="Find Second Highest Value in Excel VBA" /></p>
              

     
     
     
			  <p>1. First, we declare two Range objects and two variables of type Double. We call the Range objects rng and cell. One double variable we call highestValue, and one double variable we call secondHighestValue.</p>
			  <div class="code"><span class="predefined">Dim</span> rng <span class="predefined">As</span> Range, cell <span class="predefined">As</span> Range<br />
              <span class="predefined">Dim</span> highestValue <span class="predefined">As</span> <span class="predefined">Double</span>, secondHighestValue <span class="predefined">As</span> <span class="predefined">Double</span></div>
			  <p>2. We initialize the Range object rng with the selected range and the two Double variables with value 0.</p>
			  <div class="code"><span class="predefined">Set</span> rng = Selection<br />
              highestValue = 0<br />
		      secondHighestValue = 0</div>
			  <p>3. First, we want to find the highest value. We want to check each cell in a randomly selected range (this range can be of any size). In Excel VBA, you can use the For Each Next loop for this. Add the following code lines:</p>
			  <div class="code"><span class="comment">'Find Highest Value</span><br />
              <span class="predefined">For</span> <span class="predefined">Each</span> cell <span class="predefined">In</span> rng<br /><br />
              <span class="predefined">Next</span> cell</div>
			  <p>Note: rng and cell are randomly chosen here, you can use any names. Remember to refer to these names in the rest of your code. The green line is a comment and is only added here to provide information about this piece of code.</p>
			  <p>4. We check each cell in this range. If it's higher than highestValue, we write the value to the variable highestValue. Add the following code line to the loop.</p>
			  <div class="code"><span class="predefined">If</span> cell.Value &gt; highestValue <span class="predefined">Then</span> highestValue = cell.Value</div>
			  <p>Note: the first value is always higher than highestValue because the starting value of highestValue is 0.</p>
			  <p>5. Second, we want to find the second highest Value. We add another For Each Next loop.</p>
			  <div class="code"><span class="comment">'Find Second Highest Value</span><br />
              <span class="predefined">For</span> <span class="predefined">Each</span> cell <span class="predefined">In</span> rng<br /><br />
              <span class="predefined">Next</span> cell</div>
			  <p>6. We check each cell in the selected range again. If it's higher than secondHighestValue and lower than highestValue, we write the value to the variable secondHighestValue. Add the following code line to the loop.</p>
			  <div class="code"><span class="predefined">If</span> cell.Value &gt; secondHighestValue <span class="predefined">And</span> cell.Value &lt; highestValue <span class="predefined">Then</span> secondHighestValue = cell.Value</div>
			  <p>7. Finally, we display the second highest value using a MsgBox.</p>
			  <div class="code">MsgBox &quot;Second Highest Value is &quot; &amp; secondHighestValue</div>
			  <p>8. Place your macro in a command button, select the numbers, and click on the command button.</p>
			  <p>Result:</p>
			  <p><img src="images/find-second-highest-value/find-second-highest-value-result.png" alt="Find Second Highest Value Result" width="202" height="148" title="Find Second Highest Value Result" /></p>
			  <p>Note: understanding If Then statements and loops in Excel VBA is important if you want to write more complicated programs in the future. However, in this example, you can also use <a href="../application-object.html#worksheetfunction">WorksheetFunction</a>.Large to quickly find the second highest value.</p>
			  <p>9. The following code line produces the exact same result:</p>
			  <div class="code">MsgBox "Second Highest Value is " & WorksheetFunction.Large(Range("A1:A11"), 2)</div>
			  <p>Note: use the value 3 to find the third highest value, the value 4 to find the fourth highest value, etc.</p>
          <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     data-ad-slot="4005850092"></ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="sum-by-color.html">7/9 Completed! Learn more about if then statements &gt;<br /></a></span>Go to Next Guide: <a href="../loop.html">Loop</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../if-then-statement.html">If Then Statement</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                                              
                      	<li><a href="logical-operators.html">Logical Operators</a></li>
                        <li><a href="select-case.html">Select Case</a></li>
                        <li><a href="tax-rates.html">Tax Rates</a></li>
                        <li><a href="mod-operator.html">Mod Operator</a></li>
                        <li><a href="prime-number-checker.html">Prime Number Checker</a></li>
                        <li class="current_page_item"><a href="find-second-highest-value.html">Find Second Highest Value</a></li> 
                        <li><a href="sum-by-color.html">Sum by Color</a></li>
                        <li><a href="delete-blank-cells.html">Delete Blank Cells</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/find-second-highest-value.xlsm">find-second-highest-value.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../loop.html">Loop</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="find-second-highest-value.html">Find Second Highest Value</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d38c8ea59fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/find-second-highest-value.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:15 GMT -->
</html>
