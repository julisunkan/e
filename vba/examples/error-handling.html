<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/error-handling.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:32 GMT -->
<head>

<title>Error Handling in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="error handling, excel vba, on error resume next, ignores errors, on error goto, continues, execution, specified line, upon, hitting, error, code, negative numbers, text">
<meta name="description" content="Below we will look at two programs in Excel VBA. One program simply ignores errors. The other program continues execution at a specified line upon hitting an error.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Error Handling in Excel VBA">
<meta property="og:url" content="error-handling.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to create two programs in Excel VBA. One program simply ignores errors. The other program continues execution at a specified line upon hitting an error.">
<meta property="og:image" content="../../smi/vba/examples/error-handling-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/error-handling-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/error-handling/error-handlig.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Error Handling</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>Below we will look at two programs in <strong>Excel VBA</strong>. One program simply <strong>ignores errors</strong>. The other program <strong>continues execution at a specified line</strong> upon hitting an error.</p>
              <p>Situation:</p>
              <p>Both programs calculate the <a href="../../examples/square-root.html">square root</a> of numbers.</p>
              <p><img src="images/error-handling/error-handlig.png" alt="Error Handling in Excel VBA" width="604" height="161" title="Error Handling in Excel VBA" /></p>
              

     
     
     
              <h3>Square Root 1</h3>
              <p>Add the following code lines to the 'Square Root 1' command button.</p>
              <p>1. First, we declare two Range objects. We call the Range objects rng and cell.</p>
              <div class="code"><span class="predefined">Dim</span> rng <span class="predefined">As</span> Range, cell <span class="predefined">As</span> Range</div>
              <p>2. We initialize the Range object rng with the selected range.</p>
              <div class="code"><span class="predefined">Set</span> rng = Selection</div>
			  <p>3. We want to calculate the square root of each cell in a randomly selected range (this range can be of any size). In Excel VBA, you can use the For Each Next loop for this. Add the following code lines:</p>
			  <div class="code"><span class="predefined">For</span> <span class="predefined">Each</span> cell <span class="predefined">In</span> rng<br /><br />
              <span class="predefined">Next</span> cell</div>
			  <p>Note: rng and cell are randomly chosen here, you can use any names. Remember to refer to these names in the rest of your code.</p>
			  <p>4. Add the following code line to the loop.</p>
			  <div class="code"><span class="predefined">On Error Resume Next</span></div>
			  <p>5. Next, we calculate the square root of a value. In Excel VBA, we can use the Sqr function for this. Add the following code line to the loop.</p>
			  <div class="code">cell.Value = Sqr(cell.Value)</div>
			  <p>6. Exit the Visual Basic Editor and test the program.</p>
			  <p>Result:</p>
			  <p><img src="images/error-handling/on-error-resume-next-result.png" alt="On Error Resume Next Result" width="604" height="161" title="On Error Resume Next Result" /></p>
			  <p>Conclusion: Excel VBA has ignored cells containing invalid values such as negative numbers and text. Without using the 'On Error Resume Next' statement you would get two errors. Be careful to only use the 'On Error Resume Next' statement when you are sure ignoring errors is OK.</p>
			  <div class="ad"><!-- Advanced Excel Pages Middle -->

     
     
     
</div>
			  <h3>Square Root 2</h3>
			  <p>Add the following code lines to the  'Square Root 2' command button.</p>
			  <p>1. The same program as Square Root 1 but replace 'On Error Resume Next' with:</p>
			  <div class="code"><span class="predefined">On Error GoTo</span> InvalidValue:</div>
			  <p>Note: InvalidValue is randomly chosen here, you can use any name. Remember to refer to this name in the rest of your code.</p>
			  <p>2. Outside the For Each Next loop, first add the following code line:</p>
			  <div class="code"><span class="predefined">Exit</span> <span class="predefined">Sub</span></div>
			  <p>Without this line, the rest of the code (error code) will be executed, even if there is no error!</p>
			  <p>3. Excel VBA continues execution at the line starting with 'InvalidValue:'  upon hitting an error (don't forget the colon). Add the following code line:</p>
			  <div class="code">InvalidValue:</div>
			  <p>4. We keep our error code simple for now. We display a MsgBox with some text and the address of the cell where the error occurred.</p>
			  <div class="code">MsgBox &quot;can't calculate square root at cell &quot; &amp; cell.Address</div>
			  <p>5. Add the following line to instruct Excel VBA to resume execution after executing the error code.</p>
			  <div class="code"><span class="predefined">Resume</span> <span class="predefined">Next</span></div>
			  <p>6. Exit the Visual Basic Editor and test the program.</p>
			  <p>Result:</p>
			  <p><img src="images/error-handling/on-error-goto-result-1.png" loading="lazy" alt="On Error GoTo Result" width="252" height="148" title="On Error GoTo Result" /></p>
			  <p><img src="images/error-handling/on-error-goto-result-2.png" loading="lazy" alt="On Error GoTo Result" width="252" height="148" title="On Error GoTo Result" /></p>
			  <p><img src="images/error-handling/on-error-goto-result-3.png" loading="lazy" alt="On Error GoTo Result" width="604" height="161" title="On Error GoTo Result" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="err-object.html">3/7 Completed! Learn much more about macro errors &gt;<br /></a></span>Go to Next Guide: <a href="../string-manipulation.html">String Manipulation</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../macro-errors.html">Macro Errors</a></li>
               		    </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                                              
                      	<li><a href="debugging.html">Debugging</a></li>
                        <li class="current_page_item"><a href="error-handling.html">Error Handling</a></li>
                        <li><a href="err-object.html">Err Object</a></li>
                        <li><a href="interrupt-a-macro.html">Interrupt a Macro</a></li>
                        <li><a href="subscript-out-of-range.html">Subscript Out of Range</a></li>
                        <li><a href="macro-comments.html">Macro Comments</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/error-handling.xlsm">error-handling.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../string-manipulation.html">String Manipulation</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="error-handling.html">Error Handling</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3a1c9ff9fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/error-handling.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:33 GMT -->
</html>
