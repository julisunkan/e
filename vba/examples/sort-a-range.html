<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/sort-a-range.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:43:55 GMT -->
<head>

<title>Sort a Range in Excel VBA</title>
<meta name="keywords" content="sort, excel vba, sort method, sort range, sort using vba, dynamic sorting, currentregion, cells.sort, sort entire sheet, vba code, key1, order1">
<meta name="description" content="You can use the Sort method in Excel VBA to sort ranges in Excel. This article provides clear and practical examples to help you get started with sorting ranges using Excel VBA.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Sort a Range in Excel VBA">
<meta property="og:url" content="sort-a-range.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="You can use the Sort method in Excel VBA to sort ranges in Excel. This article provides clear and practical examples to help you get started with sorting ranges using Excel VBA.">
<meta property="og:image" content="../../smi/vba/examples/sort-a-range.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/sort-a-range.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/sort-a-range/vba-sort.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Sort a Range</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
<p class="spacing"><a href="#sort-single-column">Sort Single Column</a> | <a href="#sort-range-with-two-columns">Sort Range with Two Columns</a> | <a href="#sort-by-multiple-columns">Sort by Multiple Columns</a> | <a href="#dynamic-sorting">Dynamic Sorting</a></p>
<p>You can use the <strong>Sort method in Excel VBA</strong> to sort ranges in Excel. This article provides clear and practical examples to help you get started with sorting ranges using Excel VBA.</p>
<h3><a name="sort-single-column" id="sort-single-column"></a>Sort Single Column</h3>
<p>To sort a single column range, place a <a href="../create-a-macro.html#command-button">command button</a> on your worksheet and add the following code line:</p>
<div class="code">Range("A1:A8").Sort Key1:=Range("A1"), Order1:=xlAscending, Header:=xlNo</div>
<p>Result when you click the command button on the sheet:</p>
<p><img src="images/sort-a-range/vba-sort.png" alt="VBA Sort" width="604" height="201" title="VBA Sort" /></p>
<p>Explanation: Key1:=Range("A1") specifies the primary key to sort by, which is the first cell in the range. Order1:=xlAscending sorts the data in ascending order. Header:=xlNo indicates that the range does not have a header row.</p>


     
     
     
<h3><a name="sort-range-with-two-columns" id="sort-range-with-two-columns"></a>Sort Range with Two Columns</h3>
<p>Now, let's use the Sort method in <strong>Excel VBA to sort a range</strong> with two columns (see picture below). The Sort method works on the range A1:B8 this time.</p>
<p>To sort by the Score column in descending order, use the following code line:</p>
<div class="code">Range("A1:B8").Sort Key1:=Range("B2"), Order1:=xlDescending, Header:=xlYes</div>
<p>Result when you click the command button on the sheet:</p>
<p><img src="images/sort-a-range/sort-range-with-two-columns.png" alt="Sort Range with Two Columns" width="604" height="201" title="Sort Range with Two Columns" /></p>
<p>Explanation: Key1:=Range("B2") specifies the primary key to sort by, which is the first data cell in the Score column. We use Range("B2") because our data has headers, and the actual sorting starts from the second row. Order1:=xlDescending sorts the data in descending order. Header:=xlYes indicates that the range has a header row.</p>
<h3><a name="sort-by-multiple-columns" id="sort-by-multiple-columns"></a>Sort by Multiple Columns</h3>
<p>Now, let's use the Sort method in Excel VBA to sort by multiple columns (see picture below). The Sort method works on the range A1:C8 this time.</p>
<p>To sort by Class in ascending order and then by Score in descending order, use the following code line:</p>
<div class="code">Range("A1:C8").Sort Key1:=Range("B2"), Order1:=xlAscending, Key2:=Range("C2"), Order2:=xlDescending, Header:=xlYes</div>
<p>Result when you click the command button on the sheet:</p>
<p><img src="images/sort-a-range/use-vba-to-sort-by-multiple-columns.png" loading="lazy" alt="Use VBA to Sort by Multiple Columns" width="604" height="201" title="Use VBA to Sort by Multiple Columns" /></p>
<p>Explanation: this code uses two keys: the first key (Key1) sorts by Class in ascending order, and the second key (Key2) sorts by Score in descending order.</p>
<h3><a name="dynamic-sorting" id="dynamic-sorting"></a>Dynamic Sorting</h3>
<p>For dynamic sorting, where the number of rows frequently changes, use the <a href="currentregion.html">CurrentRegion property</a> to include new data automatically.</p>
<div class="code">Range("A1").CurrentRegion.Sort Key1:=Range("B2"), Order1:=xlDescending, Header:=xlYes</div>
<p>1. Result when you click the command button on the sheet:</p>
<p><img src="images/sort-a-range/currentregion-sort.png" loading="lazy" alt="CurrentRegion Sort" width="604" height="201" title="CurrentRegion Sort" /></p>
<p>2. Now, add a new row.</p>
<p><img src="images/sort-a-range/add-new-row.png" loading="lazy" alt="Add New Row" width="604" height="221" title="Add New Row" /></p>
<p>3. Sort again using the same VBA code line.</p>
<p><img src="images/sort-a-range/dynamic-sort-vba.png" loading="lazy" alt="Dynamic Sort in VBA" width="604" height="221" title="Dynamic Sort in VBA" /></p>
<p>4. If your data contains empty rows, the CurrentRegion method may not work as expected. In such cases, use Cells.Sort to sort your data.</p>
<div class="code">Cells.Sort Key1:=Columns("B"), Order1:=xlDescending, Header:=xlYes</div>
<p>Note: this code line sorts the entire sheet based on the specified column, even when there are empty rows. Ensure there is no data below the range to be sorted when using this code line!</p>
<div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="areas-collection.html">12/14 Completed! Learn more about the range object &gt;<br /></a></span>Go to Next Guide: <a href="../variables.html">Variables</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../range-object.html">Range Object</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
					<ul><li></li>
                      <li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="currentregion.html">CurrentRegion</a></li>
                        <li><a href="dynamic-range.html">Dynamic Range</a></li>
                        <li><a href="resize.html">Resize</a></li>
                        <li><a href="entire-rows-columns.html">Entire Rows and Columns</a></li>
                        <li><a href="offset.html">Offset</a></li>
                        <li><a href="from-active-cell-to-last-entry.html">From Active Cell to Last Entry</a></li>
                        <li><a href="union-intersect.html">Union and Intersect</a></li>
                        <li><a href="test-a-selection.html">Test a Selection</a></li>
                        <li><a href="font.html">Font</a></li>
                        <li><a href="background-colors.html">Background Colors</a></li>
						<li class="current_page_item"><a href="sort-a-range.html">Sort a Range</a></li>
                        <li><a href="areas-collection.html">Areas Collection</a></li>
                        <li><a href="compare-ranges.html">Compare Ranges</a></li>
                      	</ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/sort-a-range.xlsm">sort-a-range.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../variables.html">Variables</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="sort-a-range.html">Sort a Range</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d37c6f2c9fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/sort-a-range.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:43:57 GMT -->
</html>
