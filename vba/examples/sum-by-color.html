<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/sum-by-color.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:15 GMT -->
<head>

<title>Sum by Color in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="sum by color, excel vba, program, loop, black, red">
<meta name="description" content="Below we will look at a program in Excel VBA that sums numbers by color.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Sum by Color in Excel VBA">
<meta property="og:url" content="sum-by-color.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to create a program in Excel VBA that sums numbers by color.">
<meta property="og:image" content="../../smi/vba/examples/sum-by-color-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/sum-by-color-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/sum-by-color/sum-by-color-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Sum by Color</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>Below we will look at a program in <strong>Excel VBA</strong> that <strong>sums numbers by color</strong>.</p>
              <p>Situation:</p>
              <p>You have lent money to two twelve people. Some people have given it back (in black) and some still owe you money (red). You want to know how much money you still receive.</p>
              <p><img src="images/sum-by-color/sum-by-color-example.png" alt="Sum by Color in Excel VBA" width="604" height="301" title="Sum by Color in Excel VBA" /></p>
              

     
     
     
              <p>1. First, we declare two variables of type Integer. One named toReceive and one named i. We initialize the variable toReceive with value 0.</p>
              <div class="code"><span class="predefined">Dim</span> toReceive <span class="predefined">As</span> <span class="predefined">Integer</span>, i <span class="predefined">As</span>
              <span class="predefined">Integer</span><br />
              toReceive = 0</div>
              <p>2. Second, we start a For Next loop.</p>
              <div class="code"><span class="predefined">For</span> i = 1 <span class="predefined">To</span> 12</div>
              <p>3. We now check each number and only if the color of the number is red we add the number to toReceive.</p>
              <div class="code"><span class="predefined">If</span> Cells(i, 1).Font.Color = vbRed <span class="predefined">Then</span><br />
              &nbsp;&nbsp;&nbsp;&nbsp;toReceive = toReceive + Cells(i, 1).Value<br />
              <span class="predefined">End</span> <span class="predefined">If</span></div>
              <p>4. Don't forget to close the loop.</p>
              <div class="code"><span class="predefined">Next</span> i</div>
              <p>5. Finally, we display the money still to receive. We use the &amp; operator to concatenate (join) two strings. Although toReceive is not a string it works here.</p>
              <div class="code">MsgBox &quot;Still to receive &quot; &amp; toReceive &amp; &quot; dollars&quot;</div>
              <p>6. Place your macro in a command button and test it.</p>
              <p>Result:</p>
              <p><img src="images/sum-by-color/sum-by-color-result.png" alt="Sum by Color Result" width="179" height="148" title="Sum by Color Result" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     data-ad-slot="4005850092"></ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="delete-blank-cells.html">8/9 Completed! Learn more about if then statements &gt;<br /></a></span>Go to Next Guide: <a href="../loop.html">Loop</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../if-then-statement.html">If Then Statement</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                                              
                      	<li><a href="logical-operators.html">Logical Operators</a></li>
                        <li><a href="select-case.html">Select Case</a></li>
                        <li><a href="tax-rates.html">Tax Rates</a></li>
                        <li><a href="mod-operator.html">Mod Operator</a></li>
                        <li><a href="prime-number-checker.html">Prime Number Checker</a></li>
                        <li><a href="find-second-highest-value.html">Find Second Highest Value</a></li> 
                        <li class="current_page_item"><a href="sum-by-color.html">Sum by Color</a></li>
                        <li><a href="delete-blank-cells.html">Delete Blank Cells</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/sum-by-color.xlsm">sum-by-color.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../loop.html">Loop</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="sum-by-color.html">Sum by Color</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d38e5d1ab8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/sum-by-color.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:16 GMT -->
</html>
