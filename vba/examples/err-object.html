<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/err-object.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:33 GMT -->
<head>

<title>Err Object in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="err object, excel vba, error handling, filled, information, property, error number, description, macro, friendly message">
<meta name="description" content="If you are not familiar with Error Handling yet, we highly recommend you to read this example first. When an error in Excel VBA occurs, the properties of the Err object are filled with information.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Err Object in Excel VBA">
<meta property="og:url" content="err-object.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="If you are not familiar with Error Handling yet, we highly recommend you to read this example first. When an error in Excel VBA occurs, the properties of the Err object are filled with information.">
<meta property="og:image" content="../../smi/vba/examples/err-object-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/err-object-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/err-object/err-object-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Err Object</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>If you are not familiar with <a href="error-handling.html">Error Handling</a> yet, we highly recommend you to read this example first. When an error in <strong>Excel VBA</strong> occurs, the properties of the <strong>Err object</strong> are filled with information.</p>
              <p>Situation:</p>
              <p>The program below calculates the <a href="../../examples/square-root.html">square root</a> of numbers.</p>
              <p><img src="images/err-object/err-object-example.png" alt="Err Object in Excel VBA" width="604" height="161" title="Err Object in Excel VBA" /></p>
              

     
     
     
              <p>1. Place a <a href="../create-a-macro.html#command-button">command button</a> on your worksheet and add the following code lines:</p>
              <div class="code"><span class="predefined">Dim</span> rng <span class="predefined">As</span> Range, cell <span class="predefined">As</span> Range<br />
              <span class="predefined">Set</span> rng = Selection<br /><br />
              <span class="predefined">For</span> <span class="predefined">Each</span> cell <span class="predefined">In</span> rng<br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">On</span> <span class="predefined">Error</span> <span class="predefined">GoTo</span> InvalidValue:<br />
              &nbsp;&nbsp;&nbsp;&nbsp;cell.Value = Sqr(cell.Value)<br />
              <span class="predefined">Next</span> cell<br /><br />
              <span class="predefined">Exit</span> <span class="predefined">Sub</span><br /><br />
              InvalidValue:<br /><br />
              MsgBox Err.Number &amp; &quot; &quot; &amp; Err.Description &amp; &quot; at cell &quot; &amp; cell.Address<br /><br />
              <span class="predefined">Resume</span> <span class="predefined">Next</span></div>
              <p>Result when you select Range(&quot;B2:B6&quot;) and click the command button on the sheet:</p>
              <p><img src="images/err-object/err-object-result-1.png" alt="Err Object Result" width="305" height="148" title="Err Object Result" /></p>
              <p><img src="images/err-object/err-object-result-2.png" loading="lazy" alt="Err Object Result" width="209" height="148" title="Err Object Result" /></p>
              <p>Explanation: when an error occurs, the number property of the Err object is filled with an unique error number of the current error and the Description property is filled with the error description of the current error.</p>
              <p>2. These descriptions may not be very helpful to the users of your program. You can make the error messages more user friendly by modifying the last part of the macro as follows:</p>
              <div class="code">InvalidValue:<br /><br />
              <span class="predefined">Select</span> <span class="predefined">Case</span> Err.Number<br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">Case</span> <span class="predefined">Is</span> = 5<br />
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Can't calculate square root of negative number at cell &quot; &amp; cell.Address<br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">Case</span> <span class="predefined">Is</span> = 13<br />
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox &quot;Can't calculate square root of text at cell &quot; &amp; cell.Address<br />
              <span class="predefined">End</span> <span class="predefined">Select</span><br /><br />
              <span class="predefined">Resume</span> <span class="predefined">Next</span></div>
              <p>Tip: go through our <a href="select-case.html">Select Case</a> program to learn more about the Select Case structure.</p>
              <p>Result:</p>
              <p><img src="images/err-object/friendly-message-1.png" loading="lazy" alt="Friendly Message" width="363" height="148" title="Friendly Message" /></p>
              <p><img src="images/err-object/friendly-message-2.png" loading="lazy" alt="Friendly Message" width="293" height="148" title="Friendly Message" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="interrupt-a-macro.html">4/7 Completed! Learn much more about macro errors &gt;<br /></a></span>Go to Next Guide: <a href="../string-manipulation.html">String Manipulation</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../macro-errors.html">Macro Errors</a></li>
               		    </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                                              
                      	<li><a href="debugging.html">Debugging</a></li>
                        <li><a href="error-handling.html">Error Handling</a></li>
                        <li class="current_page_item"><a href="err-object.html">Err Object</a></li>
                        <li><a href="interrupt-a-macro.html">Interrupt a Macro</a></li>
                        <li><a href="subscript-out-of-range.html">Subscript Out of Range</a></li>
                        <li><a href="macro-comments.html">Macro Comments</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/err-object.xlsm">err-object.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../string-manipulation.html">String Manipulation</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="err-object.html">Err Object</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3a30b9c9fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/err-object.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:35 GMT -->
</html>
