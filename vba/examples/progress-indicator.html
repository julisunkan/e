<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/progress-indicator.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:45:26 GMT -->
<head>

<title>Progress Indicator in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="progress indicator, macro, excel vba, userform, frame, label, control, activate, sub, code, % completed, percentagecompleted, doevents, passing, value">
<meta name="description" content="Below we will look at a program in Excel VBA that creates a progress indicator. We've kept the progress indicator as simple as possible, yet it looks professional. Are you ready?">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Progress Indicator in Excel VBA">
<meta property="og:url" content="progress-indicator.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to create a program in Excel VBA that creates a progress indicator. We've kept the progress indicator as simple as possible, yet it looks professional. Are you ready?">
<meta property="og:image" content="../../smi/vba/examples/progress-indicator-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/progress-indicator-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/progress-indicator/progress-indicator-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Progress Indicator</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>Below we will look at a program in <strong>Excel VBA</strong> that creates a <strong>progress indicator</strong>. We've kept the progress indicator as simple as possible, yet it looks professional. Are you ready?</p>
              <p>The Userform we are going to create looks as follows:</p>
              <p><img src="images/progress-indicator/progress-indicator-example.png" alt="Progress Indicator in Excel VBA" width="305" height="110" title="Progress Indicator in Excel VBA" /></p>
              

     
     
     
              <p>To create this Userform, execute the following steps.</p>
              <p>1. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>. If the Project Explorer is not visible, click View, Project Explorer.</p>
              <p>2. Click Insert, Userform. If the Toolbox does not appear automatically, click View, Toolbox. Your screen should be set up as below.</p>
              <p><img src="../images/userform/userform-screen-setup.png" alt="Userform Screen Setup in Excel VBA" width="604" height="407" title="Userform Screen Setup in Excel VBA" /></p>
              <p>This Userform only consists of three controls. A frame control and two label controls.</p>
              <p>3. Add the frame control. You can do this by clicking on Frame from the Toolbox. Next, you can drag a frame control on the Userform. You need to change some properties of this frame control. Right mouse click on the frame control, and then click on Properties. Empty the Caption field, set the Height to 24 and Width to 204.</p>
              <p>4. Add the first label control and place it in the Frame control. Right mouse click on the label control, and then click on Properties. Change the name to Bar, BackColor to Highlight, empty the Caption field, set the Height to 20 and Width to 10.</p>
              <p>5. Add the second label control and place it above the Frame control. Right mouse click on the label control, and then click on Properties. Change the name to Text and change the Caption to '0% Completed'.</p>
              <p>6. Change the caption of the Userform to Progress Indicator.</p>
              <p>Once this has been completed, the result should be consistent with the picture of the Userform shown earlier.</p>
              <p>7. Place a command button on your worksheet and add the following code line to show the Userform:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> CommandButton1_Click()<br /><br />
              UserForm1.Show<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>If you have gone through the other Userform examples on this site, you know that this is the time to create the Sub UserForm_Initialize. This Sub runs automatically whenever the Userform is loaded. Thus, when you use the Show method for the Userform, the code will automatically be executed. Instead of the Sub UserForm_Initialize, we create the Sub UserForm_Activate. By using this sub, Excel VBA can update the Userform to show the progress of the macro.</p>
              <p>8. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p>
              <p>9. In the Project Explorer, right click on UserForm1 and then click View Code.</p>
              <p>10. Choose Userform from the left drop-down list. Choose Activate from the right drop-down list.</p>
              <p>11. Add the following code line:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> UserForm_Activate()<br /><br />
              code<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>Explanation: this sub calls another sub named code we are going to create in a minute. Confused? You can go through our <a href="../function-sub.html">Function and Sub</a> Guide to learn more about subs. If you are in a hurry, just execute the following steps and you will be fine.</p>
			  <div class="ad"><!-- Advanced Excel Pages Middle -->

     
     
     
</div>
              <p>12. Place the sub named code into a module (In the Visual Basic Editor, click Insert, Module). This is just an example. This is THE place to add your own code when you want to use this progress indicator for your own macro. The code looks as follows.</p>
              <div class="code"><span class="predefined">Sub</span> code()<br /><br />
              <span class="predefined">Dim</span> i <span class="predefined">As</span> <span class="predefined">Integer</span>, j <span class="predefined">As</span> <span class="predefined">Integer</span>, pctCompl <span class="predefined">As</span> <span class="predefined">Single</span><br /><br />
              Sheet1.Cells.Clear<br /><br />
              <span class="predefined">For</span> i = 1 <span class="predefined">To</span> 100<br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">For</span> j = 1 <span class="predefined">To</span> 1000<br />
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cells(i, 1).Value = j<br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">Next</span> j<br />
              &nbsp;&nbsp;&nbsp;&nbsp;pctCompl = i<br />
              &nbsp;&nbsp;&nbsp;&nbsp;progress pctCompl<br />
              <span class="predefined">Next</span> i<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>Explanation: first, we initialize some variables. Next, we clear sheet1. We use a double loop to show the values from 1 to 1000 in the first 100 rows of the worksheet. This will keep Excel VBA busy for a while and gives us the opportunity to see the progress of the macro. The variable pctCompl (abbreviation for percentageCompleted) measures the progress of the macro. Finally, we call another sub named progress and pass the value of the variable pctCompl to update the Userform. This way we can see the progress of the macro!</p>
              <p>13. Add another sub named progress. The code looks as follows:</p>
              <div class="code"><span class="predefined">Sub</span> progress(pctCompl <span class="predefined">As</span> <span class="predefined">Single</span>)<br /><br />
              UserForm1.Text.Caption = pctCompl &amp; &quot;% Completed&quot;<br />
              UserForm1.Bar.Width = pctCompl * 2<br /><br />
              DoEvents<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>Explanation: the first code line changes the caption of the first label control. The second code line changes the width of the second label control. Add DoEvents to update the Userform.</p>
              <p>14. Exit the Visual Basic Editor and click the command button on the sheet:</p>
              <p>Result:</p>
              <p><img src="images/progress-indicator/progress-indicator-result.png" loading="lazy" alt="Progress Indicator Result" width="604" height="301" title="Progress Indicator Result" /></p>
              <p>Note: for this macro, we used the variable i to measure the progress. For example, at row 11, 10% is completed. This may be different for your macro. The technique of passing the value of the variable pctCompl to the sub progress to update the Userform remains the same.</p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="multiple-list-box-selections.html">4/11 Completed! Learn much more about userforms &gt;<br /></a></span>Go to Next Guide: <a href="../../introduction/range.html">Range</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../userform.html">Userform</a></li>
               		    </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
					<ul><li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="userform-ranges.html">Userform and Ranges</a></li>
                        <li><a href="currency-converter.html">Currency Converter</a></li>
                        <li class="current_page_item"><a href="progress-indicator.html">Progress Indicator</a></li>
                        <li><a href="multiple-list-box-selections.html">Multiple List Box Selections</a></li>
                        <li><a href="multicolumn-combo-box.html">Multicolumn Combo Box</a></li>
                        <li><a href="dependent-combo-boxes.html">Dependent Combo Boxes</a></li>
                        <li><a href="loop-through-controls.html">Loop through Controls</a></li>
                        <li><a href="controls-collection.html">Controls Collection</a></li>
                        <li><a href="userform-with-multiple-pages.html">Userform with Multiple Pages</a></li>
                        <li><a href="interactive-userform.html">Interactive Userform</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/progress-indicator.xlsm">progress-indicator.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../../introduction/range.html">Range</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="progress-indicator.html">Progress Indicator</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3e4af1eb8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/progress-indicator.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:45:27 GMT -->
</html>
