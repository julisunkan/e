<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/rolling-average-table.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:59 GMT -->
<head>

<title>Rolling Average in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="rolling average table, excel vba, program, new stock value, worksheet change event">
<meta name="description" content="Below we will look at a program in Excel VBA that creates a rolling average table.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Rolling Average in Excel VBA">
<meta property="og:url" content="rolling-average-table.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to create a program in Excel VBA that creates a rolling average table.">
<meta property="og:image" content="../../smi/vba/examples/rolling-average-table-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/rolling-average-table-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/rolling-average-table/rolling-average-table-1.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Rolling Average Table</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>Below we will look at a program in <strong>Excel VBA</strong> that creates a <strong>rolling average table</strong>. Place a <a href="../create-a-macro.html#command-button">command button</a> on your worksheet and add the the following code line:</p>
              <div class="code">Range(&quot;B3&quot;).Value = WorksheetFunction.RandBetween(0, 100)</div>
              <p>This code line enters a random number between 0 and 100 into cell B3. We want Excel VBA to take the new stock value and place it at the first position of the rolling average table. All other values should move down one place and the last value should be deleted.</p>
              <p><img src="images/rolling-average-table/rolling-average-table-1.png" alt="Rolling Average Table in Excel VBA" width="604" height="201" title="Rolling Average Table in Excel VBA" /></p>
              

     
     
     
              <p><img src="images/rolling-average-table/rolling-average-table-2.png" alt="Rolling Average Table in Excel VBA" width="604" height="201" title="Rolling Average Table in Excel VBA" /></p>
              <p>Create a Worksheet Change Event. Code added to the Worksheet Change Event will be executed by Excel VBA when you change a cell on a worksheet.</p>
              <p>1. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p>
              <p>2. Double click on Sheet1 (Sheet1) in the Project Explorer.</p>
              <p>3. Choose Worksheet from the left drop-down list. Choose Change from the right drop-down list.</p>
              <p><img src="../images/events/worksheet-change-event.png" loading="lazy" alt="Worksheet Change Event in Excel VBA" width="604" height="277" title="Worksheet Change Event in Excel VBA" /></p>
              <p>Add the following code lines to the Worksheet Change Event:</p>
              <p>4. Declare a variable called newvalue of type Integer and two ranges (firstfourvalues and lastfourvalues).</p>
              <div class="code"><span class="predefined">Dim</span> newvalue <span class="predefined">As</span> <span class="predefined">Integer</span>, firstfourvalues <span class="predefined">As</span> Range, lastfourvalues <span class="predefined">As</span> Range</div>
              <p>5. The Worksheet Change Event listens to all changes on Sheet1. We only want Excel VBA to do something if something changes in cell B3. To achieve this, add the following code line:</p>
              <div class="code"><span class="predefined">If</span> Target.Address = &quot;$B$3&quot; <span class="predefined">Then</span><br />
              </div>
              <p>6. We initialize newvalue with the value of cell B3, firstfourvalues with Range(&quot;D3:D6&quot;) and lastfourvalues with Range(&quot;D4:D7&quot;).</p>
              <div class="code">newvalue = Range(&quot;B3&quot;).Value<br />
              <span class="predefined">Set</span> firstfourvalues = Range(&quot;D3:D6&quot;)<br />
              <span class="predefined">Set</span> lastfourvalues = Range(&quot;D4:D7&quot;)</div>
              <p>7. Now comes the simple trick. We want to update the rolling average table. You can achieve this by replacing the last four values with the first four values of the table and placing the new stock value at the first position.</p>
              <div class="code">lastfourvalues.Value = firstfourvalues.Value<br />
              Range(&quot;D3&quot;).Value = newvalue</div>
              <p>8. Don't forget to close the if statement.</p>
              <div class="code"><span class="predefined">End</span> <span class="predefined">if</span></div>
              <p>9. Finally, enter the formula =AVERAGE(D3:D7) into cell D8.</p>
              <p>10. Test the program by clicking on the command button.</p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="../events.html">6/6 Completed! Learn much more about events &gt;<br /></a></span>Go to Next Guide: <a href="../array.html">Array</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../events.html">Events</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
					<ul><li>
			      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="beforedoubleclick-event.html">BeforeDoubleClick Event</a></li>
                        <li><a href="highlight-active-cell.html">Highlight Active Cell</a></li>
                        <li><a href="create-a-footer-before-printing.html">Create a Footer Before Printing</a></li>
                        <li><a href="bills-coins.html">Bills and Coins</a></li>
                        <li class="current_page_item"><a href="rolling-average-table.html">Rolling Average Table</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/rolling-average-table.xlsm">rolling-average-table.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../array.html">Array</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="rolling-average-table.html">Rolling Average Table</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3c14dd4b8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/rolling-average-table.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:59 GMT -->
</html>
