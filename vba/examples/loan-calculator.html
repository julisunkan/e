<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/loan-calculator.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:45:23 GMT -->
<head>

<title>Loan Calculator in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="loan calculator, excel vba, worksheet, activex controls, scrollbars, smallchange, largechange, option buttons, pmt function, monthly payments, interest rate, debit">
<meta name="description" content="This page teaches you how to create a simple loan calculator in Excel VBA. The worksheet contains the following ActiveX controls: two scrollbars and two option buttons.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Loan Calculator in Excel VBA">
<meta property="og:url" content="loan-calculator.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="This page teaches you how to create a simple loan calculator in Excel VBA. The worksheet contains the following ActiveX controls: two scrollbars and two option buttons.">
<meta property="og:image" content="../../smi/vba/examples/loan-calculator-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/loan-calculator-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/loan-calculator/loan-calculator-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Loan Calculator</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>This page teaches you how to create a simple <strong>loan calculator</strong> in <strong>Excel VBA</strong>. The worksheet contains the following ActiveX controls: two scrollbars and two option buttons.</p>
              <p><img src="images/loan-calculator/loan-calculator-example.png" alt="Loan Calculator in Excel VBA" width="604" height="416" title="Loan Calculator in Excel VBA" /></p>
              

     
     
     
              <p>Note: the instructions below do not teach you how to format the worksheet. We assume that you know how to change font types, insert rows and columns, add borders, change background colors, etc.</p>
              <p>Execute the following steps to create the loan calculator:</p>
              <p>1. Add the two scrollbar controls. Click on Insert from the Developer tab and then click on Scroll Bar in the ActiveX Controls section.</p>
              <p><img src="images/loan-calculator/create-scroll-bars.png" alt="Create Scroll Bars" width="604" height="294" title="Create Scroll Bars" /></p>
              <p>2. Add the two option buttons. Click on Insert from the Developer tab and then click on Option Button in the ActiveX Controls section.</p>
              <p><img src="images/loan-calculator/create-option-buttons.png" loading="lazy" alt="Create Option Buttons" width="604" height="314" title="Create Option Buttons" /></p>
              <p>Change the following properties of the scrollbar controls (make sure Design Mode is selected).</p>
              <p>3. Right mouse click on the first scrollbar control, and then click on Properties. Set Min to 0, Max to 20, SmallChange to 0 and LargeChange to 2.</p>
              <p>4. Right mouse click on the second scrollbar control, and then click on Properties. Set Min to 5, Max to 30, SmallChange to 1, LargeChange to 5, and LinkedCell to F8.</p>
              <p>Explanation: when you click on the arrow, the scrollbar value goes up or down by SmallChange. When you click between the slider and the arrow, the scrollbar value goes up or down by LargeChange.</p>
              <div class="ad"><!-- Advanced Excel Pages Middle -->

     
     
     
</div>
              <p>Create a Worksheet Change Event. Code added to the Worksheet Change Event will be executed by Excel VBA when you change a cell on a worksheet.</p>
              <p>5. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p>
              <p>6. Double click on Sheet1 (Sheet1) in the Project Explorer.</p>
              <p>7. Choose Worksheet from the left drop-down list and choose Change from the right drop-down list.</p>
              <p><img src="../images/events/worksheet-change-event.png" loading="lazy" alt="Worksheet Change Event in Excel VBA" width="604" height="277" title="Worksheet Change Event in Excel VBA" /></p>
              <p>8. The Worksheet Change Event listens to all changes on Sheet1. We only want Excel VBA to run the Calculate sub if something changes in cell D4. To achieve this, add the following code line to the Worksheet Change Event (more about the Calculate sub later on).</p>
              <div class="code"><span class="predefined">If</span> Target.Address = &quot;$D$4&quot; <span class="predefined">Then</span> Application.Run &quot;Calculate&quot;<br />
              </div>
              <p>9. Get the right percentage in cell F6 (change the format of cell F6 to percentage). Right mouse click on the first scrollbar control, and then click on View Code. Add the following code lines:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> ScrollBar1_Change()<br /><br />
              Range(&quot;F6&quot;).Value = ScrollBar1.Value / 100<br />
              Application.Run &quot;Calculate&quot;<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>10. Right mouse click on the second scrollbar control, and then click on View Code. Add the following code line:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> ScrollBar2_Change()<br /><br />
              Application.Run &quot;Calculate&quot;<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>11. Right mouse click on the first option button control, and then click on View Code. Add the following code line:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> OptionButton1_Click()<br /><br />
              <span class="predefined">If</span> OptionButton1.Value = <span class="predefined">True</span> <span class="predefined">Then</span> Range(&quot;C12&quot;).Value = &quot;Monthly Payment&quot;<br />
              Application.Run &quot;Calculate&quot;<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>12. Right mouse click on the second option button control, and then click on View Code. Add the following code line:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> OptionButton2_Click()<br /><br />
              <span class="predefined">If</span> OptionButton2.Value = <span class="predefined">True</span> <span class="predefined">Then</span> Range(&quot;C12&quot;).Value = &quot;Yearly Payment&quot;<br />
              Application.Run &quot;Calculate&quot;<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>13. Time to create the  sub. You can go through our <a href="../function-sub.html">Function and Sub</a> Guide to learn more about subs.  If you are in a hurry, simply place the sub named Calculate into a module (In the Visual Basic Editor, click Insert, Module).</p>
              <div class="code"><span class="predefined">Sub</span> Calculate()<br /><br />
              <span class="predefined">Dim</span> loan <span class="predefined">As</span> <span class="predefined">Long</span>, rate <span class="predefined">As</span> <span class="predefined">Double</span>, nper <span class="predefined">As</span> <span class="predefined">Integer</span><br /><br />
              loan = Range(&quot;D4&quot;).Value<br />
              rate = Range(&quot;F6&quot;).Value<br />
              nper = Range(&quot;F8&quot;).Value<br /><br />
              <span class="predefined">If</span> Sheet1.OptionButton1.Value = <span class="predefined">True</span> <span class="predefined">Then</span><br />
              &nbsp;&nbsp;&nbsp;&nbsp;rate = rate / 12<br />
              &nbsp;&nbsp;&nbsp;&nbsp;nper = nper * 12<br />
              <span class="predefined">End</span> <span class="predefined">If</span><br /><br />
              Range(&quot;D12&quot;).Value = -1 * WorksheetFunction.Pmt(rate, nper, loan)<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>Explanation: the sub gets the right parameters for the worksheet function Pmt. The <a href="../../examples/pmt.html">PMT function</a> in Excel calculates the payments for a loan based on constant payments and a constant interest rate. If you make monthly payments (Sheet1.OptionButton1.Value = True), Excel VBA uses rate / 12 for rate and nper *12 for nper (total number of payments). The result is a negative number, because payments are considered a debit. Multiplying the result by -1 gives a positive result.</p>
              <p><img src="images/loan-calculator/loan-calculator-result.png" loading="lazy" alt="Loan Calculator Result" width="604" height="416" title="Loan Calculator Result" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="../activex-controls.html">8/8 Completed! Learn more about activex controls &gt;<br /></a></span>Go to Next Guide: <a href="../userform.html">Userform</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../activex-controls.html">ActiveX Controls</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
					<ul><li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="text-box.html">Text Box</a></li>
                        <li><a href="list-box.html">List Box</a></li>
                        <li><a href="combo-box.html">Combo Box</a></li>
                        <li><a href="check-box.html">Check Box</a></li>
                        <li><a href="option-buttons.html">Option Buttons</a></li>
                        <li><a href="spin-button.html">Spin Button</a></li>
                        <li class="current_page_item"><a href="loan-calculator.html">Loan Calculator</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/loan-calculator.xlsm">loan-calculator.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../userform.html">Userform</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="loan-calculator.html">Loan Calculator</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3e0d9f8b8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/loan-calculator.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:45:24 GMT -->
</html>
