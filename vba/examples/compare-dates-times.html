<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/compare-dates-times.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:44 GMT -->
<head>

<title>Compare Dates and Times in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="compare dates, times, excel vba, numbers, date function, equal to, earlier than, times, decimals, int function, whole number, morning, noon">
<meta name="description" content="This example teaches you how to compare dates and times in Excel VBA. Dates and times are stored as numbers in Excel and count the number of days since January 0, 1900. What you see depends on the number format.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Compare Dates and Times in Excel VBA">
<meta property="og:url" content="compare-dates-times.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="This example teaches you how to compare dates and times in Excel VBA. Dates and times are stored as numbers in Excel and count the number of days since January 0, 1900.">
<meta property="og:image" content="../../smi/vba/examples/compare-dates-times-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/compare-dates-times-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/compare-dates-times/numbers.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Compare Dates and Times</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
							<p>This example teaches you how to <strong>compare dates and times</strong> in <strong>Excel VBA</strong>. Dates and times are stored as numbers in Excel and count the number of days since January 0, 1900. What you see depends on the number format.</p>
              <p>1. Enter some numbers in column A.</p>
              <p><img src="images/compare-dates-times/numbers.png" alt="Numbers" width="604" height="161" title="Numbers" /></p>
              

     
     
     
              <p>2. These numbers are dates. This is a perfect way to enter some dates without worrying about the <a href="date-format.html">Date format</a>. Change the format to Date (Right click on the column A header, Format Cells and choose Date).</p>
              <p>Result:</p>
              <p><img src="images/compare-dates-times/dates.png" alt="Dates" width="604" height="161" title="Dates" /></p>
              <p>Note: Dates are in US Format. Months first, Days Second. This type of format depends on your windows regional settings.</p>
              <p>Place a <a href="../create-a-macro.html#command-button">command button</a> on your worksheet and add the following code lines:</p>
              <p>3. Declare the variable i of type Integer.</p>
              <div class="code"><span class="predefined">Dim</span> i <span class="predefined">As</span> Integer</div>
              <p>4. Add a For Next loop.</p>
              <div class="code"><span class="predefined">For</span> i = 1 To 5<br /><br />
              <span class="predefined">Next</span> i</div>
              <p>5. The Date function returns the current date without the time. Add the following code line to the loop, to highlight all the cells containing the current date (3/13/2020).</p>
              <div class="code"><span class="predefined">If</span> Cells(i, 1).Value = Date <span class="predefined">Then</span> Cells(i, 1).Font.Color = vbRed</div>
              <p>Result:</p>
              <p><img src="images/compare-dates-times/dates-equal-to.png" loading="lazy" alt="Dates Equal To" width="604" height="161" title="Dates Equal To" /></p>
              <p>6. To highlight all the dates earlier than 04/19/2019, add the following code line to the loop.</p>
              <div class="code"><span class="predefined">If</span> Cells(i, 1).Value &lt; DateValue(&quot;April 19, 2019&quot;) <span class="predefined">Then</span> Cells(i, 1).Font.Color = vbRed</div>
              <p>Result:</p>
              <p><img src="images/compare-dates-times/dates-earlier-than.png" loading="lazy" alt="Dates Earlier Than" width="604" height="161" title="Dates Earlier Than" /></p>
              <p>7. But what about times, we hear you say. They are the decimals. Switch back to General format and change the numbers to decimal numbers.</p>
              <p><img src="images/compare-dates-times/decimal-numbers.png" loading="lazy" alt="Decimal Numbers" width="604" height="161" title="Decimal Numbers" /></p>
              <div class="ad"><!-- Advanced Excel Pages Middle -->

     
     
     data-ad-slot="2529116896"></ins>
</div>
              <p>8. Now change the format to 'Date and Time' format.</p>
              <p><img src="images/compare-dates-times/date-time-format.png" loading="lazy" alt="Date and Time Format" width="532" height="484" title="Date and Time Format" /></p>
              <p>Result:</p>
              <p><img src="images/compare-dates-times/dates-times.png" loading="lazy" alt="Dates and Times" width="604" height="161" title="Dates and Times" /></p>
              <p>9. If you want to highlight all cells containing the current date, we cannot use the code line  at 5 anymore. Why not? Because the numbers in column A are decimal numbers now. Comparing it with Date (a whole number) would not give any match. (It would only give a match with 3/13/2020 at midnight exactly!) The following code line does work:</p>
              <div class="code"><span class="predefined">If</span> Int(Cells(i, 1).Value) = Date <span class="predefined">Then</span> Cells(i, 1).Font.Color = vbRed</div>
              <p>Explanation: we simply use the Int function. The Int function rounds a number down to the nearest integer. This way we can get the dates without the times and compare these dates with Date.</p>
              <p>Result:</p>
              <p><img src="images/compare-dates-times/dates-without-times-equal-to.png" loading="lazy" alt="Dates Without Times Equal To" width="604" height="161" title="Dates Without Times Equal To" /></p>
              <p>10. Add the following code line to highlight all the cells containing times in the morning.</p>
              <div class="code"><span class="predefined">If</span> (Cells(i, 1).Value - Int(Cells(i, 1).Value)) &lt; 0.5 <span class="predefined">Then</span> Cells(i, 1).Font.Color = vbRed</div>
              <p>Explanation: we only need the decimals so therefore we subtract the integer part. Noon (halfway through the day) is represented as 0.5. Decimals lower than 0.5 are the times in the morning.</p>
              <p>Result:</p>
              <p><img src="images/compare-dates-times/times-in-the-morning.png" loading="lazy" alt="Times in the Morning" width="604" height="161" title="Times in the Morning" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="datediff-function.html">2/9 Completed! Learn more about dates and times &gt;<br /></a></span>Go to Next Guide: <a href="../events.html">Events</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../date-time.html">Date and Time</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                        
                        <li class="current_page_item"><a href="compare-dates-times.html">Compare Dates and Times</a></li>
                        <li><a href="datediff-function.html">DateDiff Function</a></li>
                        <li><a href="weekdays.html">Weekdays</a></li>
                        <li><a href="delay-a-macro.html">Delay a Macro</a></li>                       
                        <li><a href="year-occurrences.html">Year Occurrences</a></li>
                        <li><a href="tasks-on-schedule.html">Tasks on Schedule</a></li>
                        <li><a href="sort-birthdays.html">Sort Birthdays</a></li>
						<li><a href="date-format.html">Date Format</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/compare-dates-times.xlsm">compare-dates-times.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../events.html">Events</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="compare-dates-times.html">Compare Dates and Times</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3b02d5c9fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/compare-dates-times.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:47 GMT -->
</html>
