<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/controls-collection.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:45:31 GMT -->
<head>

<title>Controls Collection in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="controls collection, excel vba, userform, loop through controls, property, control, specific value, vbmodeless, & operator, join elements, text box, name">
<meta name="description" content="When creating Userforms in Excel VBA, you can use the Controls collection to easily loop through controls and set a property of each control to a specific value.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Controls Collection in Excel VBA">
<meta property="og:url" content="controls-collection.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="When creating Userforms in Excel VBA, you can use the Controls collection to easily loop through controls and set a property of each control to a specific value.">
<meta property="og:image" content="../../smi/vba/examples/controls-collection-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/controls-collection-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/controls-collection/controls-collection-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Controls Collection</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
			  <p>When creating Userforms in <strong>Excel VBA</strong>, you can use the <strong>Controls collection</strong> to easily loop through controls and set a property of each control to a specific value.</p>
              <p>The Userform we are going to create looks as follows:</p>
              <p><img src="images/controls-collection/controls-collection-example.png" alt="Controls Collection in Excel VBA" width="604" height="461" title="Controls Collection in Excel VBA" /></p>
              

     
     
     
              <p>To create this Userform, execute the following steps:</p>
              <p>1. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>. If the Project Explorer is not visible, click View, Project Explorer.</p>
              <p>2. Click Insert, Userform. If the Toolbox does not appear automatically, click View, Toolbox. Your screen should be set up as below.</p>
              <p><img src="../images/userform/userform-screen-setup.png" alt="Userform Screen Setup in Excel VBA" width="604" height="407" title="Userform Screen Setup in Excel VBA" /></p>
              <p>3. Add the label, text boxes (first at the top, the second below the first, and so on) and command button. Once this has been completed, the result should be consistent with the picture of the Userform shown earlier. For example, create a text box control by clicking on TextBox  from the Toolbox. Next, you can drag a text box on the Userform.</p>
              <p>4. To change the caption of the Userform, label and command button, click View, Properties Window and click on each control.</p>
              <p>5. To show the Userform, place a <a href="../create-a-macro.html#command-button">command button</a> on your worksheet and add the following code line:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> CommandButton1_Click()<br /><br />
              UserForm1.Show vbModeless<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span></div>
              <p>Explanation: by adding vbModeless, you can use the Userform and work in your worksheet at the same time.</p>
              <p>We have now created the first part of the Userform. Although it looks neat already, nothing will happen yet when we click the command button on the Userform.</p>
              <p>6. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p>
              <p>7. In the Project Explorer, double click on UserForm1.</p>
              <p>8. Double click on the command button.</p>
              <p>9. Add the following code lines:</p>
              <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> CommandButton1_Click()<br /><br />
              <span class="predefined">Dim</span> i <span class="predefined">As</span> <span class="predefined">Integer</span><br /><br />
              <span class="predefined">For</span> i = 1 <span class="predefined">To</span> 10<br />
              &nbsp;&nbsp;&nbsp;&nbsp;Controls(&quot;TextBox&quot; &amp; i).Value = Cells(i + 1, 1).Value<br />
              <span class="predefined">Next</span> i<br /><br />
              <span class="predefined">End</span> <span class="predefined">Sub</span><br /></div>
              <p>Explanation: With just a few lines of code, we can fill the text boxes with the phone numbers from the sheet. We used the &amp; operator to concatenate (join) the elements. These code lines work because we didn't change the names of the text box controls (TextBox1, TextBox2, TextBox3, etc). To change the names of the controls, click View, Properties Window and click on each control.</p>
              <p>Result when you click the command button on the sheet:</p>
              <p><img src="images/controls-collection/controls-collection-result.png" loading="lazy" alt="Controls Collection Result" width="604" height="461" title="Controls Collection Result" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     data-ad-slot="4005850092"></ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="userform-with-multiple-pages.html">9/11 Completed! Learn much more about userforms &gt;<br /></a></span>Go to Next Guide: <a href="../../introduction/range.html">Range</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../userform.html">Userform</a></li>
               		    </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
					<ul><li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="userform-ranges.html">Userform and Ranges</a></li>
                        <li><a href="currency-converter.html">Currency Converter</a></li>
                        <li><a href="progress-indicator.html">Progress Indicator</a></li>
                        <li><a href="multiple-list-box-selections.html">Multiple List Box Selections</a></li>
                        <li><a href="multicolumn-combo-box.html">Multicolumn Combo Box</a></li>
                        <li><a href="dependent-combo-boxes.html">Dependent Combo Boxes</a></li>
                        <li><a href="loop-through-controls.html">Loop through Controls</a></li>
                        <li class="current_page_item"><a href="controls-collection.html">Controls Collection</a></li>
                        <li><a href="userform-with-multiple-pages.html">Userform with Multiple Pages</a></li>
                        <li><a href="interactive-userform.html">Interactive Userform</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/controls-collection.xlsm">controls-collection.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../../introduction/range.html">Range</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="controls-collection.html">Controls Collection</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d3ec39b5b8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/controls-collection.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:45:32 GMT -->
</html>
