<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/remove-duplicates.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:25 GMT -->
<head>

<title>Remove Duplicates in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="remove duplicates, excel vba, unique numbers, for next loop, toadd, true, macro, program">
<meta name="description" content="Below we will look at a program in Excel VBA that removes duplicates.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Remove Duplicates in Excel VBA">
<meta property="og:url" content="remove-duplicates.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to create a program in Excel VBA that removes duplicates.">
<meta property="og:image" content="../../smi/vba/examples/remove-duplicates-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../../smi/vba/examples/remove-duplicates-2.png">

<link rel="preload" href="../../css/style.css" as="style">
<link rel="preload" href="images/remove-duplicates/remove-duplicates-example.png" as="image">
<link rel="preload" href="../../js/default.js" as="script">
<link rel="preload" href="../../js/init.js" as="script">
<script async src="../../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../../css/style.css"/>
<script src="../../js/default.js" type="text/javascript"></script>
<script src="../../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../../css/skel.css" />
    <link rel="stylesheet" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/adslot.css" />
</noscript>
<link rel="icon" href="../../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../../index.html"><img src="../../layout/excel-guides.svg" onerror="this.src='../../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../../index.html">Excel</a></li>
                  <li><a href="../../introduction.html">Introduction</a></li>
				  <li><a href="../../basics.html">Basics</a></li>
				  <li><a href="../../functions.html">Functions</a></li>
				  <li><a href="../../data-analysis.html">Data Analysis</a></li>
                  <li><a href="../../vba.html">VBA</a></li>
                  <li class="current_page_item"><a href="../../examples.html">300 Examples</a></li>
                  <li><a href="../../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Remove Duplicates</h1>
						<div style="clear: both;">&nbsp;</div>
<div class="entry">
              <p>Below we will look at a program in <strong>Excel VBA</strong> that <strong>removes duplicates</strong>.</p>
              <p>Situation:</p>
              <p>In column A we have 10 numbers. We want to remove the duplicates from these numbers and place the unique numbers in column B.</p>
              <p><img src="images/remove-duplicates/remove-duplicates-example.png" alt="Remove Duplicates in Excel VBA" width="604" height="241" title="Remove Duplicates in Excel VBA" /></p>
              

     
     
     
              <p>1. First, we declare four variables. toAdd of type Boolean, uniqueNumbers of type Integer, i of type Integer, and j of type Integer.</p>
              <div class="code"><span class="predefined">Dim</span> toAdd <span class="predefined">As</span> <span class="predefined">Boolean</span>, uniqueNumbers <span class="predefined">As</span> <span class="predefined">Integer</span>, i <span class="predefined">As</span> <span class="predefined">Integer</span>, j <span class="predefined">As</span> <span class="predefined">Integer</span></div>
              <p>2. Next, we write the first number of column A to column B since the first number is always 'unique'.</p>
              <div class="code">Cells(1, 2).Value = Cells(1, 1).Value</div>
              <p>3. We initialize two variables. We've just added one number to column B, so we initialize uniqueNumbers with the value 1. We set toAdd to True assuming that the next number needs to be added as well (this is not necessarily true of course).</p>
              <div class="code">uniqueNumbers = 1<br />
              toAdd = <span class="predefined">True</span></div>
              <p>We need to determine whether the second number is 'unique' or not. This can be done in a very easy way. Only if the number is not already in column B, the second number needs to be added to column B.</p>
              <p>4. We also need to check this for the third number, fourth number, and so on. We start a <a href="../loop.html">For Next loop</a> for this.</p>
              <div class="code"><span class="predefined">For</span> i = 2 <span class="predefined">To</span> 10</div>
              <p>5. Now comes the most important part of the program. If the second number is equal to one of the numbers in column B (so far we only have one unique number), we set toAdd to False because in this case we don't want to add this number! (it is not 'unique'). At the moment uniqueNumbers is still equal to 1, but uniqueNumbers can be a whole list. To check this whole list, we need another For Next loop. Again: if the number we want to add is equal to one of the numbers in this list, toAdd will be set to False and the number will not be added. Add the following code lines:</p>
              <div class="code"><span class="predefined">For</span> j = 1 <span class="predefined">To</span> uniqueNumbers<br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">If</span> Cells(i, 1).Value = Cells(j, 2).Value <span class="predefined">Then</span><br />
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;toAdd = <span class="predefined">False</span><br />
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="predefined">End</span> <span class="predefined">If</span><br />
              <span class="predefined">Next</span> j</div>
              <p>6. Only if toAdd is still True and not set to False, Excel VBA needs to add the number to column B. At the same time, we increment uniqueNumbers by 1 because we have one unique number more now. The following code lines get the job done:</p>
              <div class="code"><span class="predefined">If</span> toAdd = <span class="predefined">True</span> <span class="predefined">Then</span><br />
              &nbsp;&nbsp;&nbsp;&nbsp;Cells(uniqueNumbers + 1, 2).Value = Cells(i, 1).Value<br />
              &nbsp;&nbsp;&nbsp;&nbsp;uniqueNumbers = uniqueNumbers + 1<br />
              <span class="predefined">End</span> <span class="predefined">If</span></div>
              <p>7. Finally, we set toAdd to True assuming the next number (third number) needs to be added. Again this is not necessarily true.</p>
              <div class="code">toAdd = <span class="predefined">True</span></div>
              <p>8. Don't forget to close the loop.</p>
              <div class="code"><span class="predefined">Next</span> i</div>
              <p>9. Place your macro in a command button and test it.</p>
              <p>Result:</p>
              <p><img src="images/remove-duplicates/remove-duplicates-result.png" alt="Remove Duplicates Result" width="604" height="241" title="Remove Duplicates Result" /></p>
              <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                  	<p align="left"><span class="buttonp"> <a href="complex-calculations.html">9/12 Completed! Learn much more about loops &gt;<br /></a></span>Go to Next Guide: <a href="../macro-errors.html">Macro Errors</a></div>
                  </div></span>
                  </div>
                  <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li><a href="../loop.html">Loop</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
                <ul><li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul> 
                        <li><a href="loop-through-defined-range.html">Loop through Defined Range</a></li>
                        <li><a href="loop-through-entire-column.html">Loop through Entire Column</a></li>
                        <li><a href="do-until-loop.html">Do Until Loop</a></li>
                        <li><a href="step-keyword.html">Step Keyword</a></li>
                        <li><a href="create-a-pattern.html">Create a Pattern</a></li>
                        <li><a href="sort-numbers.html">Sort Numbers</a></li> 
                        <li><a href="randomly-sort-data.html">Randomly Sort Data</a></li>
                        <li class="current_page_item"><a href="remove-duplicates.html">Remove Duplicates</a></li>
                        <li><a href="complex-calculations.html">Complex Calculations</a></li>
						<li><a href="possible-football-matches.html">Possible Football Matches</a></li>
                        <li><a href="knapsack-problem.html">Knapsack Problem</a></li>       	
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/remove-duplicates.xlsm">remove-duplicates.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../macro-errors.html">Macro Errors</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../../layout/x-logo.png" onmouseover="this.src='../../layout/x-logo-onmouseover.png'" onmouseout="this.src='../../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="remove-duplicates.html">Remove Duplicates</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../../introduction.html">Introduction</a> &bull; <a href="../../basics.html">Basics</a> &bull; <a href="../../functions.html">Functions</a> &bull; <a href="../../data-analysis.html">Data Analysis</a> &bull; <a href="../../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d39ade4eb8d2","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/examples/remove-duplicates.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:44:26 GMT -->
</html>
