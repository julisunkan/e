<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/userform.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:47:47 GMT -->
<head>

<title>Userform in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="userform, excel vba, create, controls, text, list, combo, check, box, frame, option, spin, command, button, label, show, userform_initialize, close, clear, transfer data, test, userform">
<meta name="description" content="This Guide teaches you how to create an Excel VBA Userform. The Userform we are going to create looks as follows:">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Userform in Excel VBA">
<meta property="og:url" content="userform.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="This Guide teaches you how to create an Excel VBA Userform.">
<meta property="og:image" content="../smi/vba/userform-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../smi/vba/userform-2.png">

<link rel="preload" href="../css/style.css" as="style">
<link rel="preload" href="images/userform/userform.png" as="image">
<link rel="preload" href="../js/default.js" as="script">
<link rel="preload" href="../js/init.js" as="script">
<script async src="../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../css/style.css"/>
<script src="../js/default.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../css/skel.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/adslot.css" />
</noscript>
<link rel="icon" href="../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../index.html"><img src="../layout/excel-guides.svg" onerror="this.src='../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../index.html">Excel</a></li>
                  <li><a href="../introduction.html">Introduction</a></li>
				  <li><a href="../basics.html">Basics</a></li>
				  <li><a href="../functions.html">Functions</a></li>
				  <li><a href="../data-analysis.html">Data Analysis</a></li>
                  <li class="current_page_item"><a href="../vba.html">VBA</a></li>
                  <li class="pro"><a href="../examples.html">300 Examples</a></li>
                  <li><a href="../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Userform</h1>
                        <div style="clear: both;">&nbsp;</div>
<div class="entry">  
<p class="spacing"><a href="#add-controls">Add the Controls</a> | <a href="#show-userform">Show the Userform</a> | <a href="#assign-macros">Assign the Macros</a> | <a href="#test-userform">Test the Userform</a></p>
<p>This Guide teaches you how to create an <strong>Excel VBA Userform</strong>. The Userform we are going to create looks as follows:</p>
<p><img src="images/userform/userform.png" alt="Excel VBA Userform" width="304" height="520" title="Excel VBA Userform" /></p>


     
     
     
<h3><a name="add-controls" id="add-controls"></a>Add the Controls</h3>
  <p>To add the controls to the Userform, execute the following steps.</p>
  <p>1. Open the <a href="create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>. If the Project Explorer is not visible, click View, Project Explorer.</p>
  <p>2. Click Insert, Userform. If the Toolbox does not appear automatically, click View, Toolbox. Your screen should be set up as below.</p>
  <p><img src="images/userform/userform-screen-setup.png" alt="Userform Screen Setup in Excel VBA" width="604" height="407" title="Userform Screen Setup in Excel VBA" /></p>
  <p>3. Add the controls listed in the table below. Once this has been completed, the result should be consistent with the picture of the Userform shown earlier. For example, create a text box control by clicking on TextBox  from the Toolbox. Next, you can drag a text box on the Userform. When you arrive at the Car frame, remember to draw this frame first before you place the two option buttons in it.</p>
  <p>4. Change the names and captions of the controls according to the table below. Names are used in the Excel VBA code. Captions are those that appear on your screen. It is good practice to change the names of controls. This will make your code easier to read. To change the names and captions of the controls, click View, Properties Window and click on each control.</p>
  <table class="gridtable" style="width:100%;">
  <colgroup>
    <col style="width: 33.33%;">
    <col style="width: 33.33%;">
    <col style="width: 33.33%;">
  </colgroup>
    <tr>
      <th><p>Control</p></th>
      <th><p>Name</p></th>
      <th><p>Caption</p></th>
    </tr>
    <tr>
      <td>Userform</td>
      <td>DinnerPlannerUserForm</td>
      <td>Dinner Planner</td>
    </tr>
    <tr>
      <td>Text Box</td>
      <td>NameTextBox</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Text Box</td>
      <td>PhoneTextBox</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>List Box</td>
      <td>CityListBox</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Combo Box</td>
      <td>DinnerComboBox</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Check Box</td>
      <td>DateCheckBox1</td>
      <td>June 13th</td>
    </tr>
    <tr>
      <td>Check Box</td>
      <td>DateCheckBox2</td>
      <td>June 20th</td>
    </tr>
    <tr>
      <td>Check Box</td>
      <td>DateCheckBox3</td>
      <td>June 27th</td>
    </tr>
    <tr>
      <td>Frame</td>
      <td>CarFrame</td>
      <td>Car</td>
    </tr>
    <tr>
      <td>Option Button</td>
      <td>CarOptionButton1</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Option Button</td>
      <td>CarOptionButton2</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Text Box</td>
      <td>MoneyTextBox</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Spin Button</td>
      <td>MoneySpinButton</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Command Button</td>
      <td>OKButton</td>
      <td>OK</td>
    </tr>
    <tr>
      <td>Command Button</td>
      <td>ClearButton</td>
      <td>Clear</td>
    </tr>
    <tr>
      <td>Command Button</td>
      <td>CancelButton</td>
      <td>Cancel</td>
    </tr>
    <tr>
      <td>7 Labels</td>
      <td> No need to change</td>
      <td>Name:, Phone Number:, etc.</td>
    </tr>
  </table><br />
  <p>Note: a combo box is a drop-down list from where a user can select an item or fill in his/her own choice. Only one of the option buttons can be selected.</p>
  <div class="ad"><!-- Advanced Excel Pages Middle -->

     
     
     
</div>
  <h3><a name="show-userform" id="show-userform"></a>Show the Userform</h3>
  <p>To show the Userform, place a <a href="create-a-macro.html#command-button">command button</a> on your worksheet and add the following code line:</p>
  <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> CommandButton1_Click()<br /><br />
  DinnerPlannerUserForm.Show<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>We are now going to create the Sub UserForm_Initialize. When you use the Show method for the Userform, this sub will automatically be executed.</p>
  <p>1. Open the <a href="create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p>
  <p>2. In the Project Explorer, right click on DinnerPlannerUserForm and then click View Code.</p>
  <p>3. Choose Userform from the left drop-down list. Choose Initialize from the right drop-down list.</p>
  <p>4. Add the following code lines:</p>
  <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> UserForm_Initialize()<br /><br />
  <span class="comment">'Empty NameTextBox</span><br />
  NameTextBox.Value = &quot;&quot;<br /><br />
  <span class="comment">'Empty PhoneTextBox</span><br />
  PhoneTextBox.Value = &quot;&quot;<br /><br />
  <span class="comment">'Empty CityListBox</span><br />
  CityListBox.Clear<br /><br />
  <span class="comment">'Fill CityListBox</span><br />
  <span class="predefined">With</span> CityListBox<br />
  &nbsp;&nbsp;&nbsp;&nbsp;.AddItem &quot;San Francisco&quot;<br />
  &nbsp;&nbsp;&nbsp;&nbsp;.AddItem &quot;Oakland&quot;<br />
  &nbsp;&nbsp;&nbsp;&nbsp;.AddItem &quot;Richmond&quot;<br />
  <span class="predefined">End</span> <span class="predefined">With</span><br /><br />
  <span class="comment">'Empty DinnerComboBox</span><br />
  DinnerComboBox.Clear<br /><br />
  <span class="comment">'Fill DinnerComboBox</span><br />
  <span class="predefined">With</span> DinnerComboBox<br />
  &nbsp;&nbsp;&nbsp;&nbsp;.AddItem &quot;Italian&quot;<br />
  &nbsp;&nbsp;&nbsp;&nbsp;.AddItem &quot;Chinese&quot;<br />
  &nbsp;&nbsp;&nbsp;&nbsp;.AddItem &quot;Frites and Meat&quot;<br />
  <span class="predefined">End</span> <span class="predefined">With</span><br />
  <span class="comment"><br />
  'Uncheck DataCheckBoxes</span><br />
  DateCheckBox1.Value = <span class="predefined">False</span><br />
  DateCheckBox2.Value = <span class="predefined">False</span><br />
  DateCheckBox3.Value = <span class="predefined">False</span><br /><br />
  <span class="comment">'Set no car as default</span><br />
  CarOptionButton2.Value = <span class="predefined">True</span><br /><br />
  <span class="comment">'Empty MoneyTextBox</span><br />
  MoneyTextBox.Value = &quot;&quot;<br /><br />
  <span class="comment">'Set Focus on NameTextBox</span><br />
  NameTextBox.SetFocus<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>Explanation: text boxes are emptied, list boxes and combo boxes are filled, check boxes are unchecked, etc.</p>
  <!--<div class="ad">Excel Pages Middle

     
     
     
</div>-->
  <h3><a name="assign-macros" id="assign-macros"></a>Assign the Macros</h3>
  <p>We have now created the first part of the Userform. Although it looks neat already, nothing will happen yet when we click the command buttons on the Userform.</p>
  <p>1. Open the <a href="create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p>
  <p>2. In the Project Explorer, double click on DinnerPlannerUserForm.</p>
  <p>3. Double click on the Money spin button.</p>
  <p>4. Add the following code line:</p>
  <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> MoneySpinButton_Change()<br /><br />
  MoneyTextBox.Text = MoneySpinButton.Value<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>Explanation: this code line updates the text box when you use the spin button.</p>
  <p>5. Double click on the OK button.</p>
  <p>6. Add the following code lines:</p>
  <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> OKButton_Click()<br /><br />
  <span class="predefined">Dim</span> emptyRow <span class="predefined">As</span> <span class="predefined">Long</span><br /><br />
  <span class="comment">'Make Sheet1 active</span><br />
  Sheet1.Activate<br /><br />
  <span class="comment">'Determine emptyRow</span><br />
  emptyRow = WorksheetFunction.CountA(Range(&quot;A:A&quot;)) + 1<br /><br />
  <span class="comment">'Transfer information</span><br />
  Cells(emptyRow, 1).Value = NameTextBox.Value<br />
  Cells(emptyRow, 2).Value = PhoneTextBox.Value<br />
  Cells(emptyRow, 3).Value = CityListBox.Value<br />
  Cells(emptyRow, 4).Value = DinnerComboBox.Value<br /><br />
  <span class="predefined">If</span> DateCheckBox1.Value = <span class="predefined">True</span> <span class="predefined">Then</span> Cells(emptyRow, 5).Value = DateCheckBox1.Caption<br /><br />
  <span class="predefined">If</span> DateCheckBox2.Value = <span class="predefined">True</span> <span class="predefined">Then</span> Cells(emptyRow, 5).Value = Cells(emptyRow,&nbsp;5).Value &amp; &quot; &quot; &amp; DateCheckBox2.Caption<br /><br />
  <span class="predefined">If</span> DateCheckBox3.Value = <span class="predefined">True</span> <span class="predefined">Then</span> Cells(emptyRow, 5).Value = Cells(emptyRow,&nbsp;5).Value &amp; &quot; &quot; &amp; DateCheckBox3.Caption<br /><br />
  <span class="predefined">If</span> CarOptionButton1.Value = <span class="predefined">True</span> <span class="predefined">Then</span><br />
  &nbsp;&nbsp;&nbsp;&nbsp;Cells(emptyRow, 6).Value = &quot;Yes&quot;<br />
  <span class="predefined">Else</span><br />
  &nbsp;&nbsp;&nbsp;&nbsp;Cells(emptyRow, 6).Value = &quot;No&quot;<br />
  <span class="predefined">End</span> <span class="predefined">If</span><br /><br />
  Cells(emptyRow, 7).Value = MoneyTextBox.Value<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>Explanation: first, we activate Sheet1. Next, we determine emptyRow. The variable emptyRow is the first empty row and increases every time a record is added. Finally, we transfer the information from the Userform to the specific columns of emptyRow.</p>
  <p>7. Double click on the Clear button.</p>
  <p>8. Add the following code line:</p>
  <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> ClearButton_Click()<br /><br />
  <span class="predefined">Call</span> UserForm_Initialize<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>Explanation: this code line calls the Sub UserForm_Initialize when you click on the Clear button.</p>
  <p>9. Double click on the Cancel Button.</p>
  <p>10. Add the following code line:</p>
  <div class="code"><span class="predefined">Private</span> <span class="predefined">Sub</span> CancelButton_Click()<br /><br />
  Unload Me<br /><br />
  <span class="predefined">End</span> <span class="predefined">Sub</span></div>
  <p>Explanation: this code line closes the Userform when you click on the Cancel  button.</p>
  <h3><a name="test-userform" id="test-userform"></a>Test the Userform</h3>
  <p>Exit the Visual Basic Editor, enter the labels shown below into row 1 and test the Userform.</p>
  <p>Result:</p>
  <p><img src="images/userform/test-userform.png" loading="lazy" alt="Test the Userform" width="604" height="121" title="Test the Userform" /></p>
  <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">
                      <p align="left"><span class="buttonp"> <a href="examples/userform-ranges.html">1/11 Completed! Learn much more about userforms &gt;<br />
                    </a></span>Go to Next Guide: <a href="../introduction/range.html">Range</a></div>
                  </div></span>
                  
			</div>
            <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li class="current_page_item"><a href="userform.html">Userform</a></li>
               		    </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
					<ul><li>
				      <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>
                        <li><a href="examples/userform-ranges.html">Userform and Ranges</a></li>
                        <li><a href="examples/currency-converter.html">Currency Converter</a></li>
                        <li><a href="examples/progress-indicator.html">Progress Indicator</a></li>
                        <li><a href="examples/multiple-list-box-selections.html">Multiple List Box Selections</a></li>
                        <li><a href="examples/multicolumn-combo-box.html">Multicolumn Combo Box</a></li>
                        <li><a href="examples/dependent-combo-boxes.html">Dependent Combo Boxes</a></li>
                        <li><a href="examples/loop-through-controls.html">Loop through Controls</a></li>
                        <li><a href="examples/controls-collection.html">Controls Collection</a></li>
                        <li><a href="examples/userform-with-multiple-pages.html">Userform with Multiple Pages</a></li>
                        <li><a href="examples/interactive-userform.html">Interactive Userform</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/userform.xlsm">userform.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="../introduction/range.html">Range</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../layout/facebook-logo.png" onmouseover="this.src='../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../layout/x-logo.png" onmouseover="this.src='../layout/x-logo-onmouseover.png'" onmouseout="this.src='../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../layout/pinterest-logo.png" onmouseover="this.src='../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../layout/linkedin-logo.png" onmouseover="this.src='../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
			  <div id="sidebar">
              <ul><li></li>
		        <li>
		          <h3><span class="notranslate">Most Popular</span></h3>
	            </li>
		        <li><ul>
                        <li><a href="range-object.html">Range Object</a></li>
                        <li><a href="loop.html">Loop</a></li>
                        <li><a href="if-then-statement.html">If Then Statement</a></li>
                        <li><a href="msgbox.html">MsgBox</a></li>
                        <li><a href="array.html">Array</a></li>
                        <li><a href="function-sub.html">Function and Sub</a></li>
                        <li><a href="userform.html">Userform</a></li>
                        </ul>
			    </li>
              </ul>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="userform.html">Userform</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../introduction.html">Introduction</a> &bull; <a href="../basics.html">Basics</a> &bull; <a href="../functions.html">Functions</a> &bull; <a href="../data-analysis.html">Data Analysis</a> &bull; <a href="../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  //$(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d45a0c739fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/userform.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:47:48 GMT -->
</html>
