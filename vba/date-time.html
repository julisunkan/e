<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">


<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/date-time.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:47:39 GMT -->
<head>

<title>Date and Time in Excel VBA (In Easy Steps)</title>
<meta name="keywords" content="date, time, excel vba, year, month, day, dim statement, datevalue function, dateadd, days, months, current date, time, now, hour, minute, second, timevalue, time serial number, macro, code">
<meta name="description" content="Learn how to work with dates and times in Excel VBA. The following macro gets the year of a date. To declare a date, use the Dim statement. To initialize a date, use the DateValue function.">

<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="index, follow">
<META content=EN-US name=LANGUAGE>
<meta property="og:title" content="Date and Time in Excel VBA">
<meta property="og:url" content="date-time.html">
<meta property="og:type" content="article">
<meta property="fb:admins" content="100003702321830">
<meta property="og:description" content="Learn how to work with dates and times in Excel VBA. To declare a date, use the Dim statement. To initialize a date, use the DateValue function.">
<meta property="og:image" content="../smi/vba/date-time-2.png"/>
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ExcelEasy">
<meta name="twitter:image" content="../smi/vba/date-time-2.png">

<link rel="preload" href="../css/style.css" as="style">
<link rel="preload" href="images/date-time/year.png" as="image">
<link rel="preload" href="../js/default.js" as="script">
<link rel="preload" href="../js/init.js" as="script">
<script async src="../../pagead2.googlesyndication.com/pagead/js/f5ca7.txt?client=ca-pub-1987456081350047765" data-overlays="bottom" crossorigin="anonymous"></script>
<link rel="preload" href="../css/style-medium.css" as="style" media="(max-width:961px)">
<link rel="preload" href="../css/style-small.css" as="style" media="(max-width:620px)">
<link rel="stylesheet" href="../css/style.css"/>
<script src="../js/default.js" type="text/javascript"></script>
<script src="../js/init.js" type="text/javascript"></script>
<style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style>
<noscript>
    <link rel="stylesheet" href="../css/skel.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/adslot.css" />
</noscript>
<link rel="icon" href="../favicon-48x48.ico">
<link rel="apple-touch-icon" href="../apple-touch-icon.png">
</head>
<body>
<header id="header">
	<div class="container">
		<span class="notranslate">
			<div id="logo">
				<a href="../index.html"><img src="../layout/excel-guides.svg" onerror="this.src='../layout/excel-guides.png'" border="0" alt="Excel guides" title="Excel guides" width="1" height="1" /><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">for Data Analysis</span></a>
                <p>#1 <a href="../index.html">Excel guides</a> on the go</p>
		  	</div>            
			<nav id="nav">
				  <ul>
                  <li><a href="../index.html">Excel</a></li>
                  <li><a href="../introduction.html">Introduction</a></li>
				  <li><a href="../basics.html">Basics</a></li>
				  <li><a href="../functions.html">Functions</a></li>
				  <li><a href="../data-analysis.html">Data Analysis</a></li>
                  <li class="current_page_item"><a href="../vba.html">VBA</a></li>
                  <li class="pro"><a href="../examples.html">300 Examples</a></li>
                  <li><a href="../ask-us.html">Ask us</a></li>
                  </ul>
				</nav>
			</span>
		</div>
	</header>
	<!-- end #header -->
	<div class="container">
		<div class="row 100%">
			<div class="8u 12u(medium)">
				<div class="post">
						<h1 class="title" style="float:left;">Date and Time</h1>
                        <div style="clear: both;">&nbsp;</div>
                      
<div class="entry"> 
<p class="spacing"><a href="#year-month-day-date">Year, Month, Day of a Date</a> | <a href="#dateadd">DateAdd</a> | <a href="#current-date-time">Current Date and Time</a> | <a href="#hour-minute-second">Hour, Minute, Second</a> | <a href="#timevalue">TimeValue</a></p>
  <p>Learn how to work with <strong>dates and times</strong> in <strong>Excel VBA</strong>.</p>
  <p>Place a <a href="create-a-macro.html#command-button">command button</a> on your worksheet and add the code lines below. To execute the code lines, click the command button on the sheet.</p>
  <h3><a name="year-month-day-date" id="year-month-day-date"></a>Year, Month, Day of a Date</h3>
  <p>The following macro gets the year of a date. To declare a date, use the Dim statement. To initialize a date, use the DateValue function.</p>
  <p>Code:</p>
  <div class="code"><span class="predefined">Dim</span> exampleDate <span class="predefined">As</span> <span class="predefined">Date<br />
  </span><br />
  exampleDate = DateValue(&quot;Jan 19, 2020&quot;)<br /><br />
  MsgBox Year(exampleDate)</div>
  

     
     
     
  <p>Result:</p>
  <p><img src="images/date-time/year.png" alt="Year of a Date in Excel VBA" width="140" height="148" title="Year of a Date in Excel VBA" /></p>
  <p>Note: Use  Month and Day to get the month and day of a date.</p>
  <h3><a name="dateadd" id="dateadd"></a>DateAdd</h3>
  <p>To add a number of days to a date, use the DateAdd function. The DateAdd function has three arguments. Fill in &quot;d&quot; for the first argument to add days. Fill in 3 for the second argument to add 3 days. The third argument represents the date to which the number of days will be added.</p>
  <p>Code:</p>
  <div class="code"><span class="predefined">Dim</span> firstDate <span class="predefined">As</span> <span class="predefined">Date</span>, secondDate <span class="predefined">As</span> <span class="predefined">Date</span><br /><br />
  firstDate = DateValue(&quot;Jan 19, 2020&quot;)<br />
  secondDate = DateAdd(&quot;d&quot;, 3, firstDate)<br /><br />
  MsgBox secondDate</div>
  <p>Result:</p>
  <p><img src="images/date-time/dateadd.png" alt="DateAdd" width="140" height="148" title="DateAdd" /></p>
  <p>Note: Change "d" to "m" to add a number of months to a date. Place your cursor on DateAdd in the Visual Basic Editor and click F1 for help on the other interval specifiers. Dates are in US Format. Months first, Days second. This type of format depends on your windows regional settings.</p>
  <h3><a name="current-date-time" id="current-date-time"></a>Current Date and Time</h3>
  <p>To get the current date and time, use the Now function.</p>
  <p>Code:</p>
  <div class="code">MsgBox Now</div>
  <p>Result:</p>
  <p><img src="images/date-time/current-date-time.png" loading="lazy" alt="Current Date and Time" width="172" height="148" title="Current Date and Time" /></p>
  <h3><a name="hour-minute-second" id="hour-minute-second"></a>Hour, Minute, Second</h3>
  <p>The get the hour of a time, use the Hour function.</p>
  <p>Code:</p>
  <div class="code">MsgBox Hour(Now)</div>
  <p>Result:</p>
  <p><img src="images/date-time/hour.png" loading="lazy" alt="Hour of the Current Time" width="140" height="148" title="Hour of the Current Time" /></p>
  <p>Note: Use Minute and Second to get the minute and second of a time.</p>
  <h3><a name="timevalue" id="timevalue"></a>TimeValue</h3>
  <p>The TimeValue function converts a string to a time serial number. The time's serial number is a number between 0 and 1. For example, noon (halfway through the day) is represented as 0.5.</p>
  <p>Code:</p>
  <div class="code">MsgBox TimeValue(&quot;9:20:01 am&quot;)</div>
  <p>Result:</p>
  <p><img src="images/date-time/timevalue.png" loading="lazy" alt="TimeValue" width="140" height="148" title="TimeValue" /></p>
  <p>Now, to clearly see that Excel handles times internally as numbers between 0 and 1, add the following code lines:</p>
  <div class="code"><span class="predefined">Dim</span> y <span class="predefined">As</span> <span class="predefined">Double</span><br />
  y = TimeValue(&quot;09:20:01&quot;)<br />
  MsgBox y</div>
  <p>Result:</p>
  <p><img src="images/date-time/time-serial-number.png" loading="lazy" alt="Time Serial Number" width="151" height="148" title="Time Serial Number" /></p>
  <div class="ad"><!-- Advanced Excel Pages End -->

     
     
     </ins>
</div>
            </div>
			   </div>
				<span class="invtab"><div class="post">
					<div style="clear: both;"></div>
                    <div class="entrylearn">  
                      <p align="left"><span class="buttonp"> <a href="examples/compare-dates-times.html">1/9 Completed! Learn more about dates and times &gt;<br />
                    </a></span>Go to Next Guide: <a href="events.html">Events</a></div>
                  </div></span>
                  
			</div>
            <div class="4u 12u(medium)">
              <div id="search">
              <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000">
                <div class="cse-branding-form" style="margin-right:0px;">
                  <form action="https://www.Advanced Excel for Data Analysis/search.html" id="cse-search-box">
                    <div>
                      <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699" />
                      <input type="hidden" name="cof" value="FORID:10" />
                      <input type="hidden" name="ie" value="UTF-8" />
                      <input type="text" name="q" placeholder="Explore Entire Guide" class="field" disabled />
                      <span class="notranslate"><input type="submit" name="sa" value="Go" class="button" disabled /></span>
                    </div>
                  </form>
                </div>
                <div class="cse-branding-logo"></div>
                <div class="cse-branding-text"></div>
              </div>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Guide</h3>
						  <ul>
							<li class="current_page_item"><a href="date-time.html">Date and Time</a></li>
                		  </ul>
					  </li>
				    </ul>
			  </div>
              <div id="sidebar">
				  <ul><li>
					    <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3>
				    </li>
					  <li><ul>                        
                        <li><a href="examples/compare-dates-times.html">Compare Dates and Times</a></li>
                        <li><a href="examples/datediff-function.html">DateDiff Function</a></li>
                        <li><a href="examples/weekdays.html">Weekdays</a></li>
                        <li><a href="examples/delay-a-macro.html">Delay a Macro</a></li>                       
                        <li><a href="examples/year-occurrences.html">Year Occurrences</a></li>
                        <li><a href="examples/tasks-on-schedule.html">Tasks on Schedule</a></li>
                        <li><a href="examples/sort-birthdays.html">Sort Birthdays</a></li>
						<li><a href="examples/date-format.html">Date Format</a></li>
                        </ul>
                    </li>
                  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate"><font color="#8FAD22">Download Excel File</font></span></h3>
						  <ul>
							<li><a href="excel-files/date-time.xlsm">date-time.xlsm</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3>Next Guide</h3>
						  <ul>
							<li><a href="events.html">Events</a></li>
                    </ul>
					  </li>
				  </ul>
			  </div>
              <div id="sidebar">
		      <h3><span class="notranslate"></span></h3>
              <p style="padding-top:7px;padding-bottom:1px"><a href="https://facebook.com/thecodedragon" target="blank" rel="nofollow"><img src="../layout/facebook-logo.png" onmouseover="this.src='../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Facebook" title="Advanced Excel on Facebook" /></a> <a href="https://twitter.com/ceoofdss" target="blank" rel="nofollow"><img src="../layout/x-logo.png" onmouseover="this.src='../layout/x-logo-onmouseover.png'" onmouseout="this.src='../layout/x-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on X" title="Advanced Excel on X" /></a> <a href="https://www.pinterest.com/julisunkan" target="blank" rel="nofollow"><img src="../layout/pinterest-logo.png" onmouseover="this.src='../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on Pinterest" title="Advanced Excel on Pinterest"></a> <a href="https://www.linkedin.com/in/digitalskeleton/" target="blank" rel="nofollow"><img src="../layout/linkedin-logo.png" onmouseover="this.src='../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Advanced Excel on LinkedIn" title="Advanced Excel on LinkedIn"></a></p>
              </div>
              <div id="sidebar">
					<ul>
				  	  <li>
                        <h3><span class="notranslate">Become an Excel Pro</span></h3>
						  <ul>
                            <li><a href="../examples.html">300 Examples</a></li>
                          </ul>
					  </li>
				  </ul>
			  </div>
              <!-- end #sidebar -->
			  <div style="clear: both;">&nbsp;</div>
		  </div>
		</div>
	</div>
	<!-- end #page -->
</div>
<div id="footer">
	<p><a href="date-time.html">Date and Time</a> &bull; &copy; AppMonster<br />
	Excel is Awesome, we'll show you: <a href="../introduction.html">Introduction</a> &bull; <a href="../basics.html">Basics</a> &bull; <a href="../functions.html">Functions</a> &bull; <a href="../data-analysis.html">Data Analysis</a> &bull; <a href="../vba.html">VBA</a></p>
</div>
<!-- end #footer -->

<script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  
</script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8c78d451bfff9fc0","version":"2024.8.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true}},"token":"c707dde3711e49e3a0cbf0020eef6a91","b":1}' crossorigin="anonymous"></script>
</body>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H0MBKVX9SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-H0MBKVX9SV');
</script>

<!-- Mirrored from www.Advanced Excel for Data Analysis/vba/date-time.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 23 Sep 2024 07:47:41 GMT -->
</html>
